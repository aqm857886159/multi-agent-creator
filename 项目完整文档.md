# é€‰é¢˜é›·è¾¾ç³»ç»Ÿ - å®Œæ•´é¡¹ç›®æ–‡æ¡£

> **Version**: v2.0 (åŒå¼•æ“ç‰ˆæœ¬)
> **ä½œè€…**: å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ
> **æ›´æ–°æ—¥æœŸ**: 2025-11-26

---

## ğŸ“š ç›®å½•

1. [é¡¹ç›®æ¦‚è§ˆ](#1-é¡¹ç›®æ¦‚è§ˆ)
2. [æ ¸å¿ƒæ¦‚å¿µä¸è®¾è®¡ç†å¿µ](#2-æ ¸å¿ƒæ¦‚å¿µä¸è®¾è®¡ç†å¿µ)
3. [ç³»ç»Ÿæ¶æ„](#3-ç³»ç»Ÿæ¶æ„)
4. [æ ¸å¿ƒä»£ç æ–‡ä»¶è¯¦è§£](#4-æ ¸å¿ƒä»£ç æ–‡ä»¶è¯¦è§£)
5. [é‡è¦é…ç½®ä¸å‚æ•°](#5-é‡è¦é…ç½®ä¸å‚æ•°)
6. [æ•°æ®æµä¸çŠ¶æ€ç®¡ç†](#6-æ•°æ®æµä¸çŠ¶æ€ç®¡ç†)
7. [å·¥å…·ç³»ç»Ÿ](#7-å·¥å…·ç³»ç»Ÿ)
8. [è¿è¡Œæµç¨‹ç¤ºä¾‹](#8-è¿è¡Œæµç¨‹ç¤ºä¾‹)
9. [è°ƒè¯•ä¸ä¼˜åŒ–æŒ‡å—](#9-è°ƒè¯•ä¸ä¼˜åŒ–æŒ‡å—)
10. [å¸¸è§é—®é¢˜æ’æŸ¥](#10-å¸¸è§é—®é¢˜æ’æŸ¥)

---

## 1. é¡¹ç›®æ¦‚è§ˆ

### 1.1 ç³»ç»Ÿå®šä½

**é€‰é¢˜é›·è¾¾** (Topic Radar) æ˜¯ä¸€ä¸ª**å¤šæ™ºèƒ½ä½“å†…å®¹å‘ç°ç³»ç»Ÿ**,ä¸“é—¨ä¸ºå†…å®¹åˆ›ä½œæµæ°´çº¿çš„**ä¸Šæ¸¸ç¯èŠ‚**è®¾è®¡ã€‚

**åœ¨æ•´ä¸ªå¤šæ™ºèƒ½ä½“åˆ›ä½œç³»ç»Ÿä¸­çš„ä½ç½®**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¤šæ™ºèƒ½ä½“å†…å®¹åˆ›ä½œæµæ°´çº¿                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  é€‰é¢˜é›·è¾¾     â”‚   â”‚  å†…å®¹åˆ†æ     â”‚   â”‚  å†…å®¹ç”Ÿæˆ     â”‚   â”‚
â”‚  â”‚ Topic Radar  â”‚ â†’ â”‚  Analyst     â”‚ â†’ â”‚  Writer      â”‚   â”‚
â”‚  â”‚              â”‚   â”‚  Agent       â”‚   â”‚  Agent       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â–²                                                     â”‚
â”‚       â”‚                                                     â”‚
â”‚       â””â”€ æœ¬é¡¹ç›®çš„èŒƒå›´                                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ ¸å¿ƒç›®æ ‡

**ç¬¬ä¸€æ€§åŸç†**: ä¸ºä¸‹æ¸¸æ™ºèƒ½ä½“æä¾›**çˆ†æ¬¾é€‰é¢˜ã€åˆ‡å…¥ç‚¹å’Œçµæ„Ÿç´ æ**

å…·ä½“è¾“å‡º:
- **çˆ†æ¬¾é€‰é¢˜** (Viral Topics): å½“å‰çƒ­é—¨/æœ‰æ½œåŠ›çš„å†…å®¹ä¸»é¢˜
- **ç‹¬ç‰¹åˆ‡å…¥ç‚¹** (Unique Angles): åŒºåˆ«äºç«å“çš„è§†è§’
- **å‚è€ƒç´ æ** (Reference Data): æ”¯æ’‘é€‰é¢˜çš„å®é™…å†…å®¹æ•°æ®

### 1.3 æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| æ™ºèƒ½ä½“æ¡†æ¶ | LangGraph | çŠ¶æ€æœºç¼–æ’,èŠ‚ç‚¹æµç¨‹æ§åˆ¶ |
| ç»“æ„åŒ–è¾“å‡º | Instructor + Pydantic | å¼ºåˆ¶ LLM è¾“å‡ºç»“æ„åŒ–æ•°æ® |
| LLMç½‘å…³ | OpenRouter | å¤šæ¨¡å‹è·¯ç”±,æˆæœ¬ä¼˜åŒ– |
| æ•°æ®é‡‡é›† | yt-dlp, bilibili-api-python | YouTube/Bç«™æ•°æ®æŠ“å– |
| é…ç½®ç®¡ç† | YAML | æ¨¡å‹é…ç½®,ç”¨æˆ·è®¾ç½® |
| ç¯å¢ƒç®¡ç† | dotenv | APIå¯†é’¥ç®¡ç† |

---

## 2. æ ¸å¿ƒæ¦‚å¿µä¸è®¾è®¡ç†å¿µ

### 2.1 åŒå¼•æ“ç­–ç•¥

ç³»ç»Ÿé‡‡ç”¨**åŒå¼•æ“å¹¶è¡Œ**çš„å†…å®¹å‘ç°ç­–ç•¥,æ¨¡æ‹Ÿä¸¤ç§ä¸åŒçš„"ç‹©çŒ"æ¨¡å¼:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŒå¼•æ“å†…å®¹å‘ç°ç³»ç»Ÿ                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  ğŸ”´ å¼•æ“1: å¤´éƒ¨åšä¸»ç›‘æ§ (Influencer Monitoring)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. Webæœç´¢ "æœ€ä½³AIåšä¸»æ¨è"                            â”‚ â”‚
â”‚  â”‚    â†“                                                  â”‚ â”‚
â”‚  â”‚ 2. æå–åšä¸»åˆ—è¡¨ (Influencer Extractor)                â”‚ â”‚
â”‚  â”‚    â†“                                                  â”‚ â”‚
â”‚  â”‚ 3. æœç´¢åšä¸»å†…å®¹ (é¡ºè—¤æ‘¸ç“œ)                             â”‚ â”‚
â”‚  â”‚    â†“                                                  â”‚ â”‚
â”‚  â”‚ 4. çºµå‘å¯¹æ¯”: å‘ç°åšä¸»"è¶…å¸¸å‘æŒ¥"çš„è§†é¢‘                   â”‚ â”‚
â”‚  â”‚    (æ¯”åšä¸»è‡ªå·±çš„å¹³å‡æ°´å¹³é«˜20%+)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                            â”‚
â”‚  ğŸ”µ å¼•æ“2: å…³é”®è¯æœç´¢ (Keyword Hunting)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. ç›´æ¥æœç´¢å†…å®¹å…³é”®è¯ "AI News 2025"                  â”‚ â”‚
â”‚  â”‚    â†“                                                  â”‚ â”‚
â”‚  â”‚ 2. æ”¶é›†å¤§é‡å€™é€‰è§†é¢‘                                    â”‚ â”‚
â”‚  â”‚    â†“                                                  â”‚ â”‚
â”‚  â”‚ 3. æ¨ªå‘å¯¹æ¯”: å‘ç°"èµ›é“é»‘é©¬"                            â”‚ â”‚
â”‚  â”‚    (æ’­æ”¾é‡/äº’åŠ¨ç‡è¿œè¶…åŒè¡Œä¸­ä½æ•°)                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸ºä»€ä¹ˆéœ€è¦åŒå¼•æ“?**

| ç»´åº¦ | å¼•æ“1 (ç›‘æ§æ¨¡å¼) | å¼•æ“2 (çŒæ€æ¨¡å¼) |
|------|-----------------|-----------------|
| **ç›®æ ‡** | å‘ç°"å¤´éƒ¨åšä¸»çš„æ–°çˆ†æ¬¾" | å‘ç°"æ–°å…´é»‘é©¬å†…å®¹" |
| **é€»è¾‘** | è·Ÿè¸ªå·²éªŒè¯çš„ä¼˜è´¨åˆ›ä½œè€… | å¹¿æ’’ç½‘,æ¨ªå‘å¯¹æ¯” |
| **ä¼˜åŠ¿** | è´¨é‡æœ‰ä¿éšœ,é£æ ¼ç¨³å®š | è¦†ç›–é¢å¹¿,å‘ç°æ–°äºº |
| **é£é™©** | å¯èƒ½é”™è¿‡æ–°å…´åˆ›ä½œè€… | å™ªéŸ³å¤š,éœ€ä¸¥æ ¼ç­›é€‰ |
| **å¯¹æ¯”åŸºå‡†** | çºµå‘(åšä¸»å†å²æ•°æ®) | æ¨ªå‘(åŒè¡Œä¸­ä½æ•°) |

### 2.2 æ ¸å¿ƒè®¾è®¡åŸåˆ™

#### åŸåˆ™1: ç¬¬ä¸€æ€§åŸç†é©±åŠ¨

**æ ¸å¿ƒé—®é¢˜**: ä¸‹æ¸¸åˆ›ä½œæ™ºèƒ½ä½“éœ€è¦ä»€ä¹ˆ?

**ç­”æ¡ˆ**:
1. **æ—¶æ•ˆæ€§**: å†…å®¹å¿…é¡»æ–°é²œ (7-30å¤©å†…)
2. **çˆ†æ¬¾æ½œåŠ›**: å·²éªŒè¯çš„é«˜è¡¨ç°å†…å®¹
3. **å·®å¼‚åŒ–**: æä¾›ç‹¬ç‰¹è§†è§’,ä¸æ˜¯ç®€å•å¤åˆ¶
4. **å¯è§£é‡Šæ€§**: æ¯ä¸ªé€‰é¢˜å¿…é¡»è¯´æ˜"ä¸ºä»€ä¹ˆæ¨è"

**æ‰€æœ‰åŠŸèƒ½å›´ç»•è¿™4ç‚¹å±•å¼€**

#### åŸåˆ™2: æ™ºèƒ½ä¸è§„åˆ™çš„å¹³è¡¡

```
ç¡®å®šæ€§é€»è¾‘ (Rules)         LLMæ™ºèƒ½å†³ç­–
     â†“                           â†“
  å¤„ç†ç®€å•çš„             å¤„ç†å¤æ‚çš„
  "å¦‚æœ-åˆ™"               åˆ›é€ æ€§å†³ç­–
     â†“                           â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ é¡ºè—¤æ‘¸ç“œé€»è¾‘ â”‚      â”‚ Planneræ™ºèƒ½ â”‚
  â”‚ çº¿ç´¢è·Ÿè¿›é€»è¾‘ â”‚  +   â”‚ æœç´¢è¯è®¾è®¡   â”‚
  â”‚ å»é‡/é™æµé€»è¾‘â”‚      â”‚ åšä¸»æå–     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
            æ··åˆå†³ç­–ç³»ç»Ÿ
```

**å½“å‰é—®é¢˜**: ç¡®å®šæ€§é€»è¾‘ä¼˜å…ˆçº§è¿‡é«˜,å‹åˆ¶äº†LLMæ™ºèƒ½
â†’ éœ€è¦è°ƒæ•´ä¼˜å…ˆçº§

#### åŸåˆ™3: å¯è§‚æµ‹æ€§ä¼˜å…ˆ

æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»è¾“å‡ºæ¸…æ™°çš„æ—¥å¿—:
- **é˜¶æ®µæ ‡è¯†**: å½“å‰å¤„äºå“ªä¸ªæ‰§è¡Œé˜¶æ®µ
- **å¼•æ“æ ‡ç­¾**: ğŸ”´/ğŸ”µ æ ‡è¯†æ•°æ®æ¥æº
- **è¿›åº¦ä»ªè¡¨ç›˜**: å®æ—¶æ˜¾ç¤ºæ”¶é›†è¿›åº¦
- **å†³ç­–ç†ç”±**: Planner çš„æ€è€ƒè¿‡ç¨‹

---

## 3. ç³»ç»Ÿæ¶æ„

### 3.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  main.py (å…¥å£)                                              â”‚
â”‚  - äº¤äº’å¼CLI                                                 â”‚
â”‚  - é…ç½®åŠ è½½                                                  â”‚
â”‚  - çŠ¶æ€åˆå§‹åŒ–                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LangGraph å·¥ä½œæµ (core/graph.py)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Keyword      â”‚ â†’ â”‚ Planner      â”‚ â‡„ â”‚ Executor     â”‚   â”‚
â”‚  â”‚ Designer     â”‚   â”‚ (æ™ºèƒ½è§„åˆ’)   â”‚   â”‚ (å·¥å…·æ‰§è¡Œ)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚       â”‚                           â”‚
â”‚                         â†“       â†“                           â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚              â”‚ Influencer   â”‚  â”‚ Filter       â”‚            â”‚
â”‚              â”‚ Extractor    â”‚  â”‚ (æ™ºèƒ½ç­›é€‰)   â”‚            â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                        â†“                    â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                               â”‚ Architect    â”‚             â”‚
â”‚                               â”‚ (é€‰é¢˜ç­–åˆ’)   â”‚             â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·¥å…·å±‚ (tools/)                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - web_search.py        (Googleæœç´¢)                         â”‚
â”‚  - youtube_scout.py     (YouTubeä¸‰é˜¶æ®µçˆ†æ¬¾ç­›é€‰)              â”‚
â”‚  - bilibili_adapter.py  (Bç«™æ™ºèƒ½åˆ†é¡µ)                       â”‚
â”‚  - ... (å…¶ä»–å·¥å…·)                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ ¸å¿ƒæœåŠ¡å±‚ (core/)                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - llm.py           (ModelGateway: LLMè·¯ç”±ä¸è°ƒç”¨)            â”‚
â”‚  - tool_registry.py (å·¥å…·æ³¨å†Œè¡¨)                             â”‚
â”‚  - state.py         (PydanticçŠ¶æ€æ¨¡å‹)                       â”‚
â”‚  - config.py        (é…ç½®åŠ è½½)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 LangGraph èŠ‚ç‚¹æµç¨‹

```mermaid
graph TD
    A[START] --> B[Keyword Designer]
    B --> C{Planner Router}

    C -->|Webæœç´¢ç»“æœ & æœªæå–åšä¸»| D[Influencer Extractor]
    D --> C

    C -->|plan_status=executing| E[Executor]
    E --> C

    C -->|plan_status=finished| F[Filter]
    F --> G[Architect]
    G --> H[END]

    C -->|ç»§ç»­è§„åˆ’| C

    style B fill:#e1f5ff
    style D fill:#ffe1e1
    style E fill:#fff4e1
    style F fill:#e1ffe1
    style G fill:#f0e1ff
```

**èŠ‚ç‚¹è¯´æ˜**:

| èŠ‚ç‚¹ | ä½œç”¨ | å…³é”®è¾“å…¥ | å…³é”®è¾“å‡º |
|------|------|---------|---------|
| **Keyword Designer** | è®¾è®¡æœç´¢è¯ | target_domains | discovery_queries, content_queries |
| **Planner** | æ™ºèƒ½è§„åˆ’ä¸‹ä¸€æ­¥è¡ŒåŠ¨ | å†å²è®°å½•, è¿›åº¦ | tool_call (è¦æ‰§è¡Œçš„å·¥å…·) |
| **Executor** | æ‰§è¡Œå·¥å…·è°ƒç”¨ | tool_call | tool_result, candidates |
| **Influencer Extractor** | ä»æ–‡ç« æå–åšä¸» | leads (Webæœç´¢ç»“æœ) | discovered_influencers |
| **Filter** | æ™ºèƒ½ç­›é€‰çˆ†æ¬¾ | candidates | filtered_candidates |
| **Architect** | ç”Ÿæˆé€‰é¢˜ç­–åˆ’ | filtered_candidates | proposals |

### 3.3 çŠ¶æ€æœºè®¾è®¡

LangGraph çš„æ ¸å¿ƒæ˜¯**çŠ¶æ€æœº** (State Machine),æ‰€æœ‰èŠ‚ç‚¹å…±äº«ä¸€ä¸ªå…¨å±€çŠ¶æ€ `RadarState`ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RadarState (å…¨å±€çŠ¶æ€)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  é…ç½®è¾“å…¥:                                                   â”‚
â”‚  - target_domains: List[str]        # ç›®æ ‡é¢†åŸŸ               â”‚
â”‚  - monitoring_list: Dict[str, List] # ç™½åå•åšä¸»             â”‚
â”‚  - session_focus: Dict              # æœ¬æ¬¡ä¼šè¯å…³æ³¨ç‚¹          â”‚
â”‚                                                             â”‚
â”‚  è¿è¡Œæ•°æ®:                                                   â”‚
â”‚  - candidates: List[ContentItem]    # æ”¶é›†çš„å†…å®¹             â”‚
â”‚  - leads: List[LeadItem]            # Webæœç´¢çº¿ç´¢            â”‚
â”‚  - discovered_influencers: List     # å‘ç°çš„åšä¸»             â”‚
â”‚                                                             â”‚
â”‚  æ‰§è¡Œæ§åˆ¶:                                                   â”‚
â”‚  - plan_status: str                 # "executing"/"finished"â”‚
â”‚  - plan_scratchpad: List[Dict]      # è§„åˆ’å†å²è®°å½•           â”‚
â”‚  - platform_search_progress: Dict   # å¹³å°æœç´¢å®Œæˆæ ‡å¿—       â”‚
â”‚                                                             â”‚
â”‚  è¾“å‡ºç»“æœ:                                                   â”‚
â”‚  - filtered_candidates: List        # ç­›é€‰åçš„ä¼˜è´¨å†…å®¹       â”‚
â”‚  - proposals: List[TopicBrief]      # æœ€ç»ˆé€‰é¢˜ç­–åˆ’           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é‡è¦å­—æ®µè¯¦è§£**:

```python
class RadarState(BaseModel):
    # ğŸ”‘ é…ç½®å±‚
    target_domains: List[str]
    # ä¾‹å¦‚: ["AI News", "Python Tutorials"]

    monitoring_list: Dict[str, List[str]]
    # ä¾‹å¦‚: {"youtube": ["@channel_id1"], "bilibili": ["UPä¸»ID"]}

    session_focus: Dict[str, Any]
    # æœ¬æ¬¡è¿è¡Œçš„ç”¨æˆ·è¾“å…¥:
    # {
    #   "priority_topics": ["nano banana"],
    #   "priority_platforms": ["youtube", "bilibili"]
    # }

    # ğŸ”‘ åŒå¼•æ“å…³é”®å­—æ®µ
    discovery_queries: List[str]
    # å‘ç°åšä¸»çš„æœç´¢è¯ (å¼•æ“1å‡†å¤‡)
    # ä¾‹å¦‚: ["best AI channels 2025", "é¡¶çº§AIåšä¸»æ¨è"]

    content_queries: List[str]
    # ç›´æ¥æœç´¢å†…å®¹çš„å…³é”®è¯ (å¼•æ“2)
    # ä¾‹å¦‚: ["AI News 2025-11", "Python tutorial 2025"]

    discovered_influencers: List[InfluencerInfo]
    # æå–çš„åšä¸»åˆ—è¡¨
    # [
    #   InfluencerInfo(name="Matt Wolfe", platform="youtube",
    #                  identifier="@mreflow", confidence="high")
    # ]

    searched_influencers: List[str]
    # å·²æœç´¢è¿‡çš„åšä¸»æ ‡è¯† (å»é‡ç”¨)

    # ğŸ”‘ æ•°æ®æ”¶é›†
    candidates: List[ContentItem]
    # æ‰€æœ‰æ”¶é›†çš„å†…å®¹

    leads: List[LeadItem]
    # Webæœç´¢çš„è½»é‡çº§çº¿ç´¢

    # ğŸ”‘ æ‰§è¡Œæ§åˆ¶
    plan_status: str
    # "planning" | "executing" | "finished"

    plan_scratchpad: List[Dict]
    # è§„åˆ’å†å²,è®°å½•æ¯æ¬¡å†³ç­–å’Œç»“æœ
    # [
    #   {
    #     "tool_call": {"tool_name": "web_search", "arguments": {...}},
    #     "tool_result": {"status": "success", "data": [...]}
    #   }
    # ]

    platform_search_progress: Dict[str, bool]
    # {"youtube": True, "bilibili": False}
    # ç”¨äºåˆ¤æ–­æ˜¯å¦å®Œæˆäº†å¹³å°æœç´¢
```

---

## 4. æ ¸å¿ƒä»£ç æ–‡ä»¶è¯¦è§£

### 4.1 main.py - ç³»ç»Ÿå…¥å£

**èŒè´£**:
1. äº¤äº’å¼CLIæ”¶é›†ç”¨æˆ·è¾“å…¥
2. åŠ è½½é…ç½®
3. åˆå§‹åŒ–çŠ¶æ€
4. å¯åŠ¨LangGraphå·¥ä½œæµ
5. å±•ç¤ºç»“æœ

**å…³é”®æµç¨‹**:

```python
def main():
    # ç¬¬1æ­¥: åŠ è½½YAMLé…ç½®
    settings = load_settings()  # ä» config/settings.yaml

    # ç¬¬2æ­¥: äº¤äº’å¼æ”¶é›†ç”¨æˆ·è¾“å…¥
    settings, session_focus, topic_targets = interactive_startup(settings)

    # ç¬¬3æ­¥: åˆå§‹åŒ–å…¨å±€çŠ¶æ€
    initial_state = RadarState(
        target_domains=settings.get("target_domains", []),
        monitoring_list=settings.get("whitelist_kols", {}),
        session_focus=session_focus,
        topic_targets=topic_targets
    )

    # ç¬¬4æ­¥: æ‰§è¡ŒLangGraphå·¥ä½œæµ
    final_state = app.invoke(
        initial_state,
        config={"recursion_limit": 50}  # æœ€å¤§æ‰§è¡Œ50æ­¥
    )

    # ç¬¬5æ­¥: è¾“å‡ºç»“æœ
    for proposal in final_state["proposals"]:
        print(f"æ ‡é¢˜: {proposal.title}")
        print(f"åˆ‡å…¥ç‚¹: {proposal.core_angle}")
```

**å…³é”®é…ç½®**:

```python
# Windows UTF-8 æ”¯æŒ (å¤„ç†emojiå’Œä¸­æ–‡)
if sys.platform == "win32":
    sys.stdout.reconfigure(encoding='utf-8')

# LangGraph é€’å½’é™åˆ¶
config={"recursion_limit": 50}
# é˜²æ­¢æ— é™å¾ªç¯,æœ€å¤šæ‰§è¡Œ50ä¸ªèŠ‚ç‚¹è½¬æ¢
```

**äº¤äº’å¼è¾“å…¥**:

```python
def _collect_session_focus(settings):
    """æ”¶é›†ç”¨æˆ·æœ¬æ¬¡è¿è¡Œçš„å…³æ³¨ç‚¹"""
    focus = {
        "priority_topics": [],      # ä¼˜å…ˆä¸»é¢˜
        "priority_platforms": [],   # ä¼˜å…ˆå¹³å°
        "priority_authors": [],     # å…³æ³¨ä½œè€…
        "desired_metrics": [],      # è§‚å¯ŸæŒ‡æ ‡
        "notes": ""                 # å¤‡æ³¨
    }

    # ç”¨æˆ·è¾“å…¥: "æœ¬è½®ä¼˜å…ˆå…³æ³¨å“ªäº›ä¸»é¢˜?"
    topic_input = input("æœ¬è½®ä¼˜å…ˆå…³æ³¨å“ªäº›ä¸»é¢˜? (é€—å·åˆ†éš”): ")
    # ä¾‹å¦‚: "AI nano banana"

    if topic_input:
        focus["priority_topics"] = [t.strip() for t in topic_input.split(",")]

    return focus
```

---

### 4.2 core/state.py - çŠ¶æ€æ¨¡å‹å®šä¹‰

**èŒè´£**: å®šä¹‰æ‰€æœ‰Pydanticæ•°æ®æ¨¡å‹

**æ ¸å¿ƒæ¨¡å‹**:

#### ContentItem (å†…å®¹é¡¹)

```python
class ContentItem(BaseModel):
    """å•ä¸ªå†…å®¹çš„å®Œæ•´ä¿¡æ¯"""

    platform: str           # "youtube" | "bilibili"
    source_type: str        # "youtube_search" | "youtube_monitor" | ...

    # åŸºç¡€ä¿¡æ¯
    title: str
    url: str

    # ä½œè€…ä¿¡æ¯
    author_name: str
    author_id: str
    author_fans: int = 0
    author_avg_views: int = 0   # ğŸ”‘ çºµå‘å¯¹æ¯”çš„åŸºå‡†

    # è¡¨ç°æ•°æ®
    publish_time: str
    view_count: int = 0
    interaction: int = 0        # likes + comments + shares

    # è¯„åˆ†
    score: float = 0.0          # ç­›é€‰å™¨è®¡ç®—çš„åˆ†æ•°

    # æ‰©å±•æ•°æ®
    raw_data: Dict[str, Any] = Field(default_factory=dict)
    # {
    #   "viral_score": 4.2,           # çˆ†æ¬¾åˆ†
    #   "engine": "å¼•æ“1-é¡ºè—¤æ‘¸ç“œ",
    #   "from_influencer_search": True,
    #   "tags": ["AI", "Tutorial"]
    # }
```

**å…³é”®å­—æ®µè¯´æ˜**:

| å­—æ®µ | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| `author_avg_views` | å¼•æ“1çºµå‘å¯¹æ¯”åŸºå‡† | åšä¸»å¹³å‡æ’­æ”¾é‡: 150,000 |
| `view_count` | å½“å‰è§†é¢‘æ’­æ”¾é‡ | 300,000 (2å€äºå¹³å‡) |
| `interaction` | äº’åŠ¨ç‡è®¡ç®— | likes(5K) + comments(500) = 5,500 |
| `score` | ç­›é€‰å™¨è¯„åˆ† | 85.2 (å¼•æ“1æ ‡å‡†) |
| `raw_data["engine"]` | æ•°æ®æ¥æºæ ‡è¯† | "å¼•æ“1-é¡ºè—¤æ‘¸ç“œ" or "å¼•æ“2-å…³é”®è¯æœç´¢" |

#### InfluencerInfo (åšä¸»ä¿¡æ¯)

```python
class InfluencerInfo(BaseModel):
    """ä»æ¨èæ–‡ç« ä¸­æå–çš„åšä¸»ä¿¡æ¯"""

    name: str                   # "Matt Wolfe"
    platform: str               # "youtube"
    identifier: str             # "@mreflow" æˆ– "é¢‘é“URL"

    mention_count: int = 1      # åœ¨æ–‡ç« ä¸­è¢«æåŠæ¬¡æ•° (æƒé‡)
    source_url: str = ""        # æ¥æºæ–‡ç« URL
    confidence: str = "medium"  # "high" | "medium" | "low"
```

**ç”¨é€”**:
- Influencer Extractor è¾“å‡º
- Planner é¡ºè—¤æ‘¸ç“œçš„è¾“å…¥

#### LeadItem (çº¿ç´¢)

```python
class LeadItem(BaseModel):
    """Webæœç´¢ç»“æœçš„è½»é‡çº§è¡¨ç¤º"""

    title: str              # æ–‡ç« æ ‡é¢˜
    url: str                # æ–‡ç« URL
    snippet: str = ""       # æ‘˜è¦
    source: str = "web_search"
    topic_hint: str = "general"
    tags: List[str] = []    # æå–çš„å…³é”®è¯/åšä¸»å
```

**è®¾è®¡ç†å¿µ**:
- Webæœç´¢è¿”å›çš„ä¸æ˜¯å®Œæ•´å†…å®¹,è€Œæ˜¯"çº¿ç´¢"
- çº¿ç´¢ç”¨äºåšä¸»æå–å’Œåç»­è·Ÿè¿›
- è½»é‡çº§è®¾è®¡,å‡å°‘å†…å­˜å ç”¨

---

### 4.3 core/graph.py - LangGraph å·¥ä½œæµå®šä¹‰

**èŒè´£**: å®šä¹‰èŠ‚ç‚¹å’Œè¾¹çš„è¿æ¥å…³ç³»

**å®Œæ•´æµç¨‹ä»£ç **:

```python
from langgraph.graph import StateGraph, END

workflow = StateGraph(RadarState)

# ğŸ”‘ æ·»åŠ èŠ‚ç‚¹
workflow.add_node("keyword_designer", keyword_designer.run_keyword_designer)
workflow.add_node("planner", planner.run_planner)
workflow.add_node("executor", executor.run_executor)
workflow.add_node("influencer_extractor", influencer_extractor.run_influencer_extractor)
workflow.add_node("filter", filter.run_hybrid_filter)
workflow.add_node("architect", architect.run_architect)

# ğŸ”‘ è®¾ç½®å…¥å£
workflow.set_entry_point("keyword_designer")

# ğŸ”‘ å®šä¹‰è·¯ç”±å‡½æ•°
def planner_router(state: RadarState):
    """Plannerä¹‹åçš„è·¯ç”±å†³ç­–"""

    # ä¼˜å…ˆçº§1: å¦‚æœæœ‰Webæœç´¢ç»“æœä¸”æœªæå–åšä¸» â†’ åšä¸»æå–
    if state.leads and not state.discovered_influencers:
        return "influencer_extractor"

    # ä¼˜å…ˆçº§2: å¦‚æœPlannerå†³å®šæ‰§è¡Œå·¥å…· â†’ Executor
    if state.plan_status == "executing":
        return "executor"

    # ä¼˜å…ˆçº§3: å¦‚æœæ”¶é›†å®Œæˆ â†’ Filter
    elif state.plan_status == "finished":
        return "filter"

    # å¦åˆ™: ç»§ç»­è§„åˆ’
    else:
        return "planner"

# ğŸ”‘ æ·»åŠ æ¡ä»¶è¾¹
workflow.add_conditional_edges(
    "planner",
    planner_router,
    {
        "executor": "executor",
        "filter": "filter",
        "planner": "planner",
        "influencer_extractor": "influencer_extractor"
    }
)

# ğŸ”‘ å›ºå®šè¾¹
workflow.add_edge("executor", "planner")        # æ‰§è¡Œå®Œå›åˆ°è§„åˆ’
workflow.add_edge("filter", "architect")        # ç­›é€‰åè¿›å…¥ç­–åˆ’
workflow.add_edge("architect", END)             # ç­–åˆ’å®Œæˆ,ç»“æŸ

# ç¼–è¯‘å·¥ä½œæµ
app = workflow.compile()
```

**è·¯ç”±é€»è¾‘è¯¦è§£**:

```
Planner è¾“å‡º plan_status
         â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
  â”‚             â”‚
æ£€æŸ¥ leads?   plan_status?
  â”‚             â”‚
  â†“             â†“
æœ‰ä¸”æœªæå–    executing  finished  planning
  â†“             â†“         â†“         â†“
Influencer  Executor   Filter   Planner
Extractor                        (å¾ªç¯)
```

**å…³é”®è®¾è®¡**:
- `plan_status` æ˜¯Plannerä¸å…¶ä»–èŠ‚ç‚¹çš„é€šä¿¡æœºåˆ¶
- Routeræ£€æŸ¥å¤šä¸ªæ¡ä»¶,ä¼˜å…ˆçº§æ˜ç¡®
- å…è®¸Plannerè‡ªå¾ªç¯,å®ç°å¤šæ­¥è§„åˆ’

---

### 4.4 nodes/keyword_designer.py - æœç´¢è¯è®¾è®¡å¸ˆ

**èŒè´£**: ä¸ºåŒå¼•æ“è®¾è®¡ç²¾å‡†çš„æœç´¢è¯

**è¾“å…¥**: `target_domains` (å¦‚ ["AI News", "Python Tutorials"])

**è¾“å‡º**:
- `discovery_queries`: å‘ç°åšä¸»çš„æœç´¢è¯
- `content_queries`: æœç´¢å†…å®¹çš„å…³é”®è¯

**æ ¸å¿ƒé€»è¾‘**:

```python
def run_keyword_designer(state: RadarState) -> Dict[str, Any]:
    target_domains = state.target_domains
    current_year = "2025"
    current_month = "2025-11"

    # ğŸ”‘ è°ƒç”¨LLMè®¾è®¡æœç´¢è¯
    user_prompt = f"""
    ç›®æ ‡é¢†åŸŸ: {target_domains}
    å½“å‰æ—¥æœŸ: {current_month}

    è®¾è®¡ä¸¤ç±»æœç´¢è¯:

    1. discovery_queries (3-5ä¸ª):
       - ç›®çš„: æ‰¾åˆ°"æ¨èæ–‡ç« " (å¦‚ "2025å¹´å¿…çœ‹çš„AIé¢‘é“")
       - è‹±æ–‡ç¤ºä¾‹: "best AI News YouTube channels 2025"
       - ä¸­æ–‡ç¤ºä¾‹: "é¡¶çº§AIæ–°é—»åšä¸»æ¨è"

    2. content_queries (3-5ä¸ª):
       - ç›®çš„: ç›´æ¥æœç´¢è§†é¢‘å†…å®¹
       - å¿…é¡»åŒ…å«æ—¶é—´é™å®š
       - è‹±æ–‡ç¤ºä¾‹: "AI News 2025-11"
       - ä¸­æ–‡ç¤ºä¾‹: "äººå·¥æ™ºèƒ½æœ€æ–°åŠ¨æ€ 2025-11"
    """

    result: KeywordDesignerOutput = get_llm_with_schema(
        user_prompt=user_prompt,
        response_model=KeywordDesignerOutput,
        capability="reasoning"  # ä½¿ç”¨æ¨ç†æ¨¡å‹
    )

    return {
        "discovery_queries": result.discovery_queries,
        "content_queries": result.content_queries
    }
```

**è¾“å‡ºç¤ºä¾‹**:

```python
{
    "discovery_queries": [
        "best AI News YouTube channels 2025",
        "top Python Tutorials influencers to follow 2025",
        "2025å¹´å¿…çœ‹çš„AI Newsåšä¸»æ¨è",
        "Pythonæ•™ç¨‹UPä¸»æ¨è 2025é¡¶çº§"
    ],
    "content_queries": [
        "AI News latest 2025-11",
        "Python tutorial 2025",
        "äººå·¥æ™ºèƒ½æœ€æ–°åŠ¨æ€ 2025-11",
        "Pythonå®æˆ˜æ•™ç¨‹ 2025"
    ]
}
```

**è®¾è®¡è¦ç‚¹**:
- ä¸­è‹±æ–‡æ··åˆ,è¦†ç›–YouTubeå’ŒBilibili
- æ—¶é—´é”šç‚¹ç¡®ä¿æ—¶æ•ˆæ€§
- discovery vs contentçš„åŒºåˆ†å¾ˆé‡è¦

**ğŸ”´ å½“å‰é—®é¢˜**:
- ç”¨æˆ·è¾“å…¥çš„ `session_focus["priority_topics"]` æœªè¢«ä½¿ç”¨
- éœ€è¦æ•´åˆç”¨æˆ·è¾“å…¥åˆ°æœç´¢è¯è®¾è®¡ä¸­

---

### 4.5 nodes/planner.py - æ™ºèƒ½è§„åˆ’å¤§è„‘

**èŒè´£**: å†³å®šä¸‹ä¸€æ­¥æ‰§è¡Œå“ªä¸ªå·¥å…·

**è¾“å…¥**:
- å†å²è®°å½• (`plan_scratchpad`)
- å½“å‰è¿›åº¦ (`len(candidates)`)
- å·¥å…·åˆ—è¡¨ (`tool_schemas`)

**è¾“å‡º**:
- `tool_call`: è¦æ‰§è¡Œçš„å·¥å…·è°ƒç”¨
- `plan_status`: "executing" | "finished" | "planning"

**æ ¸å¿ƒæµç¨‹**:

```python
def run_planner(state: RadarState) -> Dict[str, Any]:
    collected = len(state.candidates)
    TARGET = 50

    # ğŸ”‘ æ­¥éª¤1: æ£€æŸ¥æ˜¯å¦å®Œæˆ
    if collected >= TARGET:
        return {"plan_status": "finished"}

    # ğŸ”‘ æ­¥éª¤2: ç¡®å®šæ€§è§„åˆ’ (ä¼˜å…ˆçº§é«˜)
    deterministic_action = _deterministic_plan(state, ...)
    if deterministic_action:
        tool_name, arguments, reasoning = deterministic_action

        action = ToolCall(
            tool_name=tool_name,
            arguments=arguments,
            reasoning=reasoning
        )

        state.plan_scratchpad.append({"tool_call": action.model_dump()})
        return {"plan_status": "executing"}

    # ğŸ”‘ æ­¥éª¤3: LLMæ™ºèƒ½è§„åˆ’
    user_prompt = f"""
    å½“å‰å·²æ”¶é›†: {collected}/{TARGET} æ¡

    å¯ç”¨å·¥å…·: {tool_schemas}

    æ‰§è¡Œå†å²: {history_text}

    **åŒå¼•æ“ç­–ç•¥çŠ¶æ€**:
    - å‘ç°åšä¸»æœç´¢è¯å·²è®¾è®¡: {"æ˜¯" if state.discovery_queries else "å¦"}
    - Webæœç´¢å·²æ‰§è¡Œ: {"æ˜¯" if state.leads else "å¦"}
    - åšä¸»å·²æå–: {"æ˜¯" if state.discovered_influencers else "å¦"}

    **å…³é”®ç­–ç•¥**:
    1. å¦‚æœdiscovery_querieså·²è®¾è®¡ä½†Webæœç´¢æœªæ‰§è¡Œ:
       â†’ ç«‹å³ä½¿ç”¨ web_search æœç´¢ç¬¬ä¸€ä¸ªdiscovery_query

    2. å¹³å°å¹³è¡¡ç­–ç•¥:
       - å¿…é¡»åŒæ—¶å°è¯•YouTubeå’ŒBilibili
       - å¦‚æœå·²æ‰§è¡Œyoutube_search,ä¸‹ä¸€æ­¥åº”è¯¥æ‰§è¡Œbilibili_search

    è¯·è§„åˆ’ä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚
    """

    plan: PlannerOutput = get_llm_with_schema(
        user_prompt=user_prompt,
        response_model=PlannerOutput,
        capability="reasoning"
    )

    if plan.action:
        state.plan_scratchpad.append({"tool_call": plan.action.model_dump()})
        return {"plan_status": "executing"}
    else:
        return {"plan_status": "finished"}
```

**ç¡®å®šæ€§è§„åˆ’é€»è¾‘** (`_deterministic_plan`):

```python
def _deterministic_plan(state, ...):
    """
    ä¼˜å…ˆçº§æ’åº:
    1. é¡ºè—¤æ‘¸ç“œ (æœç´¢å·²å‘ç°çš„åšä¸»)
    2. çº¿ç´¢è·Ÿè¿› (è·Ÿè¿›Webæœç´¢ç»“æœ)
    3. ç›‘æ§æ‰§è¡Œ (ç›‘æ§å¾…ç›‘æ§é˜Ÿåˆ—)
    """

    # ğŸ”‘ ä¼˜å…ˆçº§1: é¡ºè—¤æ‘¸ç“œ
    influencer_action = _schedule_influencer_search(state)
    if influencer_action:
        return influencer_action  # ğŸ”´ è¿™é‡Œç›´æ¥è¿”å›,è·³è¿‡åç»­

    # ğŸ”‘ ä¼˜å…ˆçº§2: æ£€æŸ¥å¹³å°æœç´¢æ˜¯å¦å®Œæˆ
    youtube_searched = state.platform_search_progress["youtube"]
    bilibili_searched = state.platform_search_progress["bilibili"]

    if not (youtube_searched and bilibili_searched):
        return None  # è®©LLMå†³ç­–

    # ğŸ”‘ ä¼˜å…ˆçº§3: ç›‘æ§æ‰§è¡Œ
    monitor_action = _schedule_pending_monitor(state)
    return monitor_action
```

**é¡ºè—¤æ‘¸ç“œé€»è¾‘**:

```python
def _schedule_influencer_search(state):
    """æœç´¢å·²å‘ç°çš„åšä¸»å†…å®¹"""

    if not state.discovered_influencers:
        return None

    # æŒ‰ç½®ä¿¡åº¦å’ŒæåŠæ¬¡æ•°æ’åº
    sorted_influencers = sorted(
        state.discovered_influencers,
        key=lambda x: (confidence_score[x.confidence], x.mention_count),
        reverse=True
    )

    # æ‰¾ç¬¬ä¸€ä¸ªæœªæœç´¢çš„åšä¸»
    for influencer in sorted_influencers:
        if influencer.identifier in state.searched_influencers:
            continue  # å·²æœç´¢,è·³è¿‡

        # æ‰¾åˆ°äº†!
        if influencer.platform == "youtube":
            keyword = f"{influencer.name} {target_domain}"
            reasoning = f"é¡ºè—¤æ‘¸ç“œ:æœç´¢é¡¶çº§åšä¸» {influencer.name}"

            # ğŸ”‘ æ ‡è®°ä¸ºå·²æœç´¢
            state.searched_influencers.append(influencer.identifier)

            return ("youtube_search", {"keyword": keyword}, reasoning)

    return None  # æ‰€æœ‰åšä¸»éƒ½æœç´¢å®Œäº†
```

**ğŸ”´ å½“å‰é—®é¢˜åˆ†æ**:

1. **ç¡®å®šæ€§é€»è¾‘ä¼˜å…ˆçº§è¿‡é«˜**
   - `_deterministic_plan` åœ¨LLMä¹‹å‰æ‰§è¡Œ
   - ä¸€æ—¦æœ‰åšä¸»,å°±ä¸€ç›´è¿”å›YouTubeæœç´¢
   - LLMçš„å¹³å°å¹³è¡¡é€»è¾‘æ°¸è¿œæ‰§è¡Œä¸åˆ°

2. **Webæœç´¢åªæœç´¢ç¬¬ä¸€ä¸ªquery**
   - æç¤ºè¯è¯´ "æœç´¢ç¬¬ä¸€ä¸ªdiscovery_query"
   - ä½†discovery_queriesæœ‰5ä¸ª (ä¸­è‹±æ–‡æ··åˆ)
   - åªæœè‹±æ–‡ â†’ åªå‘ç°YouTubeåšä¸»

3. **ç¼ºå°‘å»é‡æ£€æŸ¥**
   - `searched_influencers` æ£€æŸ¥identifier
   - ä½†å¯èƒ½æœ‰é‡å¤çš„influencerå¯¹è±¡ (åŒä¸€ä¸ªäººè¢«æå–å¤šæ¬¡)

---

### 4.6 nodes/executor.py - å·¥å…·æ‰§è¡Œå™¨

**èŒè´£**:
1. æ‰§è¡ŒPlannerå†³å®šçš„å·¥å…·è°ƒç”¨
2. å°†ç»“æœå†™å…¥çŠ¶æ€
3. å…¥åº“æ•°æ®åˆ°candidates

**æ ¸å¿ƒæµç¨‹**:

```python
def run_executor(state: RadarState) -> Dict[str, Any]:
    # ğŸ”‘ æ­¥éª¤1: è·å–æœ€åä¸€ä¸ªtool_call
    last_entry = state.plan_scratchpad[-1]
    tool_call = last_entry.get("tool_call")

    tool_name = tool_call["tool_name"]
    tool_args = tool_call["arguments"]

    # ğŸ”‘ æ­¥éª¤2: åº”ç”¨é»˜è®¤å‚æ•°
    _apply_default_params(tool_name, tool_args)

    # ğŸ”‘ æ­¥éª¤3: ä»æ³¨å†Œè¡¨è·å–å·¥å…·
    tool_def = registry.get_tool(tool_name)

    # ğŸ”‘ æ­¥éª¤4: æ‰§è¡Œå·¥å…·
    result: ToolResult = tool_def.func(tool_args)

    # ğŸ”‘ æ­¥éª¤5: ä¿å­˜ç»“æœåˆ°scratchpad
    last_entry["tool_result"] = result.model_dump()

    # ğŸ”‘ æ­¥éª¤6: å…¥åº“æ•°æ®
    if result.status == "success" and result.data:
        new_items = []
        for item in result.data:
            # è¡¥å……å­—æ®µ
            if "source_type" not in item:
                item["source_type"] = tool_name
            if "platform" not in item:
                item["platform"] = "web"

            ci = ContentItem(**item)
            new_items.append(ci)

        state.candidates.extend(new_items)
        print(f"ğŸ“¥ å…¥åº“: {len(new_items)} æ¡æ•°æ®")

    return {
        "plan_status": "planning",  # å›åˆ°Planner
        "candidates": state.candidates
    }
```

**é»˜è®¤å‚æ•°åº”ç”¨**:

```python
DEFAULT_PARAMS = {
    "web_search": {"limit": 15, "depth": "advanced"},
    "youtube_search": {"limit": 15, "days": 30},
    "bilibili_search": {"limit": 15, "days": 30, "fetch_size": 100},
    "youtube_monitor": {"limit": 10, "days": 30},
    "bilibili_monitor": {"limit": 10},
}

def _apply_default_params(tool_name, tool_args):
    defaults = DEFAULT_PARAMS.get(tool_name)
    if not defaults:
        return

    for key, default_value in defaults.items():
        current = tool_args.get(key)
        if isinstance(default_value, (int, float)):
            # å¦‚æœç”¨æˆ·æ²¡è®¾ç½®æˆ–è®¾ç½®å¤ªå°,ä½¿ç”¨é»˜è®¤å€¼
            if current is None or current < default_value:
                tool_args[key] = default_value
```

**æ•°æ®æºå‘ç°** (`_harvest_sources`):

```python
def _harvest_sources(state, items, source_label):
    """ä»æ”¶é›†çš„å†…å®¹ä¸­æå–é¢‘é“/UPä¸»,åŠ å…¥å¾…ç›‘æ§é˜Ÿåˆ—"""

    for ci in items:
        # YouTubeè§†é¢‘ â†’ æå–é¢‘é“
        if ci.platform == "youtube":
            if ci.author_id:
                channel_url = f"https://www.youtube.com/channel/{ci.author_id}"
                _enqueue_source(state, "youtube", channel_url)

        # Bç«™è§†é¢‘ â†’ æå–UPä¸»
        if ci.platform == "bilibili":
            if ci.author_id:
                _enqueue_source(state, "bilibili", ci.author_id)

def _enqueue_source(state, platform, identifier):
    """åŠ å…¥å¾…ç›‘æ§é˜Ÿåˆ— (å¸¦å»é‡å’Œé™æµ)"""

    # ğŸ”‘ æ£€æŸ¥æ˜¯å¦å·²ç›‘æ§è¿‡
    if identifier in state.monitored_sources[platform]:
        return

    # ğŸ”‘ æ£€æŸ¥æ˜¯å¦å·²åœ¨é˜Ÿåˆ—
    if identifier in state.pending_monitors[platform]:
        return

    # ğŸ”‘ é™åˆ¶é˜Ÿåˆ—é•¿åº¦
    MAX = 10
    if len(state.pending_monitors[platform]) >= MAX:
        return

    # åŠ å…¥é˜Ÿåˆ—
    state.pending_monitors[platform].append(identifier)
    state.logs.append(f"ã€å‘ç°ã€‘åŠ å…¥{platform}å¾…ç›‘æ§ï¼š{identifier}")
```

---

### 4.7 nodes/influencer_extractor.py - åšä¸»æå–å™¨

**èŒè´£**: ä»Webæœç´¢ç»“æœä¸­æå–åšä¸»ä¿¡æ¯

**è¾“å…¥**: `state.leads` (Webæœç´¢çš„æ–‡ç« )

**è¾“å‡º**: `discovered_influencers`

**æ ¸å¿ƒé€»è¾‘**:

```python
def run_influencer_extractor(state: RadarState):
    web_results = state.leads

    # ğŸ”‘ æ­¥éª¤1: å‡†å¤‡ä¸Šä¸‹æ–‡
    context_parts = []
    for idx, lead in enumerate(web_results, 1):
        context_parts.append(f"""
ã€æ–‡ç«  {idx}ã€‘
æ ‡é¢˜: {lead.title}
URL: {lead.url}
æ‘˜è¦: {lead.snippet}
æ ‡ç­¾: {', '.join(lead.tags)}
        """)

    context_str = "\n\n".join(context_parts)

    # ğŸ”‘ æ­¥éª¤2: LLMæå–
    user_prompt = f"""
    ç›®æ ‡é¢†åŸŸ: {state.target_domains}

    ä»¥ä¸‹æ˜¯æ¨èæ–‡ç« :
    {context_str}

    ä»»åŠ¡: ä»è¿™äº›æ–‡ç« ä¸­æå–é¡¶çº§åšä¸»/é¢‘é“ä¿¡æ¯ã€‚

    æå–è¦æ±‚:
    1. å¯»æ‰¾è¢«æ¨èçš„å†…å®¹åˆ›ä½œè€… (YouTubeé¢‘é“, Bç«™UPä¸»)
    2. æå–:
       - name: åšä¸»åç§°
       - platform: "youtube" or "bilibili"
       - identifier: @handle æˆ– é¢‘é“URL æˆ– UID
       - confidence: "high" (æ˜ç¡®æ¨è) | "medium" | "low"
    3. ä¼˜å…ˆæå–å¤šæ¬¡å‡ºç°çš„åšä¸»
    4. ä¸è¦æå–æ–‡ç« ä½œè€…
    """

    result: InfluencerExtractorOutput = get_llm_with_schema(
        user_prompt=user_prompt,
        response_model=InfluencerExtractorOutput,
        capability="creative"  # é•¿ä¸Šä¸‹æ–‡å¤„ç†
    )

    # ğŸ”‘ æ­¥éª¤3: æ’åº (é«˜ç½®ä¿¡åº¦ + å¤šæ¬¡æåŠ ä¼˜å…ˆ)
    sorted_influencers = sorted(
        result.influencers,
        key=lambda x: (confidence_score[x.confidence], x.mention_count),
        reverse=True
    )

    # ğŸ”‘ æ­¥éª¤4: è½¬æ¢ä¸ºå­—å…¸ (LangGraphè¦æ±‚)
    influencer_dicts = [inf.model_dump() for inf in sorted_influencers]

    return {
        "discovered_influencers": influencer_dicts,
        "plan_status": "planning"  # å›åˆ°Plannerç»§ç»­è§„åˆ’
    }
```

**è¾“å‡ºç¤ºä¾‹**:

```python
{
    "influencers": [
        {
            "name": "Matt Wolfe",
            "platform": "youtube",
            "identifier": "@mreflow",
            "mention_count": 4,
            "confidence": "high"
        },
        {
            "name": "AI Explained",
            "platform": "youtube",
            "identifier": "AI Explained",
            "mention_count": 2,
            "confidence": "high"
        }
    ],
    "summary": "ä»15ç¯‡æ–‡ç« ä¸­æå–äº†11ä¸ªYouTubeé¢‘é“..."
}
```

**ğŸ”´ å½“å‰é—®é¢˜**:
- æ²¡æœ‰å»é‡é€»è¾‘!
- å¦‚æœMatt Wolfeè¢«æåŠ4æ¬¡,å¯èƒ½ç”Ÿæˆ4ä¸ªInfluencerInfoå¯¹è±¡
- å¯¼è‡´Planneré‡å¤æœç´¢åŒä¸€ä¸ªåšä¸»

**ä¿®å¤æ–¹æ¡ˆ** (åœ¨æ–‡æ¡£åé¢çš„"é—®é¢˜æ’æŸ¥"éƒ¨åˆ†):
```python
def _deduplicate_influencers(influencers):
    deduped = {}
    for inf in influencers:
        key = f"{inf.platform}:{inf.identifier.lower()}"
        if key in deduped:
            deduped[key].mention_count += inf.mention_count
        else:
            deduped[key] = inf
    return list(deduped.values())
```

---

### 4.8 nodes/filter.py - æ™ºèƒ½ç­›é€‰å™¨

**èŒè´£**: ä»å¤§é‡candidatesä¸­ç­›é€‰å‡º"å¼‚å¸¸ä¼˜è´¨"çš„å†…å®¹

**æ ¸å¿ƒè®¾è®¡ç†å¿µ**: **åˆ†å¼€ç­›é€‰å¼•æ“1å’Œå¼•æ“2**

```python
def run_hybrid_filter(state: RadarState):
    # ğŸ”‘ æ­¥éª¤1: å»é‡
    state.candidates = _deduplicate_candidates(state.candidates)

    # ğŸ”‘ æ­¥éª¤2: æŒ‰æ¥æºåˆ†ç»„
    monitor_items = [i for i in state.candidates if
                     i.source_type in ["youtube_monitor", "bilibili_monitor"]]

    hunter_items = [i for i in state.candidates if
                    i.source_type in ["youtube_search", "bilibili_search"]]

    valid_items = []

    # ğŸ”‘ æ­¥éª¤3: å¼•æ“1ç­›é€‰ (çºµå‘å¼‚å¸¸æ£€æµ‹)
    for item in monitor_items:
        # æ—¶æ•ˆæ€§æ£€æŸ¥
        if not _check_time(item.publish_time, days=7):
            continue

        # çºµå‘å¯¹æ¯”: ä¸åšä¸»è‡ªå·±æ¯”
        if item.author_avg_views > 0:
            ratio = item.view_count / item.author_avg_views

            if ratio > 1.2:  # æ¯”å¹³æ—¶å¥½20%
                item.score = 80.0 + (ratio * 10)
                item.raw_data["engine"] = "å¼•æ“1-å¤´éƒ¨åšä¸»ç›‘æ§"
                item.raw_data["detection_type"] = "çºµå‘å¼‚å¸¸"
                valid_items.append(item)

    # ğŸ”‘ æ­¥éª¤4: å¼•æ“2ç­›é€‰ (æ¨ªå‘å¯¹æ¯”)
    if hunter_items:
        # è®¡ç®—ä¸­ä½æ•°åŸºå‡†
        median_views = statistics.median([i.view_count for i in hunter_items])

        for item in hunter_items:
            if not _check_time(item.publish_time, days=30):
                continue

            # æ¨ªå‘å¯¹æ¯”: ä¸åŒè¡Œæ¯”
            is_view_outlier = (item.view_count > median_views * 1.5)

            fans = item.author_fans or 5000
            interaction = item.interaction or (item.view_count * 0.02)
            engagement_rate = interaction / fans

            is_eng_outlier = (engagement_rate > 0.01)

            if is_view_outlier or is_eng_outlier:
                item.score = 60.0 + score_boost
                item.raw_data["engine"] = "å¼•æ“2-å…³é”®è¯æœç´¢"
                valid_items.append(item)

    # ğŸ”‘ æ­¥éª¤5: æ’åºå¹¶æˆªå–Top 10
    valid_items.sort(key=lambda x: x.score, reverse=True)
    top_items = valid_items[:10]

    return {
        "filtered_candidates": top_items
    }
```

**ä¸¤ç§ç­›é€‰æ ‡å‡†å¯¹æ¯”**:

| ç»´åº¦ | å¼•æ“1 (çºµå‘) | å¼•æ“2 (æ¨ªå‘) |
|------|-------------|-------------|
| **å¯¹æ¯”åŸºå‡†** | `author_avg_views` | `median_views` (æ‰€æœ‰å€™é€‰) |
| **ç­›é€‰æ¡ä»¶** | `view_count / avg_views > 1.2` | `view_count > median * 1.5` |
| **æ—¶æ•ˆæ€§** | 7å¤©å†… | 30å¤©å†… |
| **è¯„åˆ†èŒƒå›´** | 80-100åˆ† | 60-80åˆ† |
| **æ£€æµ‹ç±»å‹** | "çºµå‘å¼‚å¸¸" (åšä¸»è¶…å¸¸å‘æŒ¥) | "æ¨ªå‘å¼‚å¸¸" (èµ›é“é»‘é©¬) |

**ğŸ”´ å½“å‰é—®é¢˜**:

1. **source_type åˆ†ç»„ä¸å‡†ç¡®**
   - `monitor_items` åªåŒ…å« `*_monitor`
   - ä½†"é¡ºè—¤æ‘¸ç“œ"çš„æ•°æ®æ¥è‡ª `youtube_search`,è¢«è¯¯åˆ†åˆ° `hunter_items`
   - å¯¼è‡´å¼•æ“1çš„æ•°æ®ç”¨å¼•æ“2çš„æ ‡å‡†ç­›é€‰

2. **æ¨ªå‘å¯¹æ¯”çš„çŸ›ç›¾**
   - æ”¶é›†äº†åŒä¸€ä¸ªåšä¸»çš„15ä¸ªtopè§†é¢‘
   - å®ƒä»¬å½¼æ­¤æ˜¯ç«å“,ä¸­ä½æ•°å¾ˆé«˜
   - æ²¡æœ‰ä»»ä½•ä¸€ä¸ªèƒ½è¶…è¿‡ä¸­ä½æ•°1.5å€
   - ç»“æœ: 0æ¡é€šè¿‡

**ä¿®å¤æ–¹æ¡ˆ**:
```python
# executor.py æ ‡è®°é¡ºè—¤æ‘¸ç“œçš„æ•°æ®
if tool_name in ["youtube_search", "bilibili_search"]:
    if tool_args.get("from_influencer"):
        ci.raw_data["from_influencer_search"] = True

# filter.py ä¿®æ”¹åˆ†ç»„é€»è¾‘
monitor_items = [i for i in state.candidates if
                 i.source_type in ["youtube_monitor", "bilibili_monitor"] or
                 i.raw_data.get("from_influencer_search")]
```

---

### 4.9 nodes/architect.py - é€‰é¢˜ç­–åˆ’å¸ˆ

**èŒè´£**: å°†ç­›é€‰åçš„ä¼˜è´¨å†…å®¹è½¬åŒ–ä¸ºé€‰é¢˜ç­–åˆ’

**è¾“å…¥**: `filtered_candidates` (Top 10ä¼˜è´¨å†…å®¹)

**è¾“å‡º**: `proposals` (é€‰é¢˜ç®€æŠ¥)

**æ ¸å¿ƒé€»è¾‘**:

```python
def run_architect(state: RadarState):
    items = state.filtered_candidates

    if not items:
        return {"proposals": []}

    # ğŸ”‘ æ­¥éª¤1: å‡†å¤‡å€™é€‰å†…å®¹æ‘˜è¦
    candidates_summary = []
    for item in items:
        candidates_summary.append({
            "title": item.title,
            "platform": item.platform,
            "author": item.author_name,
            "views": item.view_count,
            "score": item.score,
            "engine": item.raw_data.get("engine", ""),
            "url": item.url
        })

    # ğŸ”‘ æ­¥éª¤2: LLMç­–åˆ’
    user_prompt = f"""
    ç­›é€‰å‡ºçš„ä¼˜è´¨å†…å®¹:
    {json.dumps(candidates_summary, ensure_ascii=False, indent=2)}

    ä»»åŠ¡: ç”Ÿæˆ3-5ä¸ªé€‰é¢˜ç­–åˆ’

    è¦æ±‚:
    1. æ¯ä¸ªé€‰é¢˜å¿…é¡»æœ‰æ˜ç¡®çš„"åˆ‡å…¥ç‚¹" (core_angle)
       - ä¸æ˜¯ç®€å•å¤åˆ¶æ ‡é¢˜
       - è¦æ‰¾åˆ°ç‹¬ç‰¹è§†è§’

    2. é€‰é¢˜ç±»å‹:
       - "viral_hit": åŸºäºçˆ†æ¬¾å†…å®¹çš„é€‰é¢˜
       - "competitor": ç«å“åˆ†æå‹é€‰é¢˜
       - "trend": è¶‹åŠ¿è§‚å¯Ÿå‹é€‰é¢˜

    3. æ¨èç†ç”±è¦è¯´æ˜:
       - ä¸ºä»€ä¹ˆè¿™ä¸ªé€‰é¢˜å€¼å¾—åš
       - åŸºäºå“ªäº›æ•°æ®æ”¯æ’‘
       - æ¥è‡ªå“ªä¸ªå¼•æ“
    """

    result = get_llm_with_schema(
        user_prompt=user_prompt,
        response_model=ArchitectOutput,
        capability="creative"
    )

    # ğŸ”‘ æ­¥éª¤3: è½¬æ¢ä¸ºTopicBrief
    proposals = []
    for brief in result.topic_briefs:
        proposal = TopicBrief(
            id=f"topic_{len(proposals)+1}",
            title=brief.title,
            core_angle=brief.core_angle,
            rationale=brief.rationale,
            source_type=brief.source_type,
            reference_data=brief.reference_data
        )
        proposals.append(proposal)

    return {"proposals": proposals}
```

**è¾“å‡ºç¤ºä¾‹**:

```python
{
    "proposals": [
        {
            "id": "topic_1",
            "title": "Nano Banana æ·±åº¦æµ‹è¯„: AIå·¥å…·çš„ä¸‹ä¸€ä¸ªé£å£?",
            "core_angle": "ä»Matt Wolfeçš„50+ç”¨æ³•è§†é¢‘ä¸­,æç‚¼å‡º3ä¸ªæœ€æœ‰å®æˆ˜ä»·å€¼çš„åœºæ™¯",
            "rationale": "è¯¥è§†é¢‘çˆ†æ¬¾åˆ†9.96,è¿œè¶…åšä¸»å¹³å‡æ°´å¹³,è¯´æ˜Nano Bananaç¡®å®å¼•èµ·äº†å¼ºçƒˆå…³æ³¨ã€‚åˆ‡å…¥ç‚¹èšç„¦'å®æˆ˜åœºæ™¯',åŒºåˆ«äºæ³›æ³›çš„åŠŸèƒ½ä»‹ç»ã€‚",
            "source_type": "viral_hit",
            "reference_data": [
                {
                    "title": "50+ INSANE Ways To Use Nano Banana",
                    "url": "...",
                    "views": 350000,
                    "viral_score": 9.96
                }
            ]
        }
    ]
}
```

---

## 5. é‡è¦é…ç½®ä¸å‚æ•°

### 5.1 config/settings.yaml

```yaml
# ç›®æ ‡é¢†åŸŸé…ç½®
target_domains:
  - "AI News"
  - "Python Tutorials"
  - "Tech Reviews"

# ç™½åå•åšä¸» (é¢„è®¾ç›‘æ§åˆ—è¡¨)
whitelist_kols:
  youtube:
    - "https://www.youtube.com/channel/UCxxxxx"
  bilibili:
    - "123456"  # UPä¸»UID
```

### 5.2 config/models.yaml

```yaml
# OpenRouter é…ç½®
openrouter:
  site_url: "https://your-site.com"
  site_name: "Topic Radar"

# æ¨¡å‹èƒ½åŠ›æ˜ å°„
models:
  # å¿«é€Ÿä»»åŠ¡ (å·¥å…·è°ƒç”¨)
  fast:
    model_id: "deepseek/deepseek-chat"
    temperature: 0.3
    max_tokens: 2000
    timeout: 30

  # æ¨ç†ä»»åŠ¡ (è§„åˆ’)
  reasoning:
    model_id: "deepseek/deepseek-r1"
    temperature: 0.7
    max_tokens: 4000
    timeout: 60

  # åˆ›æ„ä»»åŠ¡ (ç­–åˆ’, é•¿ä¸Šä¸‹æ–‡)
  creative:
    model_id: "anthropic/claude-3.5-sonnet"
    temperature: 0.8
    max_tokens: 8000
    timeout: 90
```

**æ¨¡å‹é€‰æ‹©å»ºè®®**:

| ä»»åŠ¡ç±»å‹ | æ¨èæ¨¡å‹ | ç†ç”± |
|---------|---------|------|
| Planner | DeepSeek-R1 | æ¨ç†èƒ½åŠ›å¼º,æˆæœ¬ä½ |
| Keyword Designer | DeepSeek-R1 | éœ€è¦æ¨ç†æœç´¢ç­–ç•¥ |
| Influencer Extractor | Claude Sonnet | é•¿ä¸Šä¸‹æ–‡,æå–ç²¾å‡† |
| Architect | Claude Sonnet | åˆ›æ„ç­–åˆ’,æ–‡æ¡ˆè´¨é‡é«˜ |
| Filter | (æ— LLM) | çº¯ç®—æ³•,æ— éœ€LLM |

### 5.3 .env ç¯å¢ƒå˜é‡

```bash
# LLM APIé…ç½®
LLM_API_KEY=sk-or-v1-xxxxx
LLM_BASE_URL=https://openrouter.ai/api/v1

# Bilibiliå‡­è¯ (å¯é€‰,ä½†å¼ºçƒˆæ¨è)
MY_SESSDATA=xxxxx
MY_BUVID3=xxxxx

# Googleæœç´¢API (å¯é€‰)
SERPER_API_KEY=xxxxx
```

**è·å–æ–¹å¼**:

- **OpenRouter**: https://openrouter.ai/keys
- **Bilibiliå‡­è¯**: æµè§ˆå™¨ç™»å½•Bç«™ â†’ F12 â†’ Application â†’ Cookies â†’ å¤åˆ¶SESSDATAå’Œbuvid3
- **Serper**: https://serper.dev/api-key

### 5.4 å…³é”®å‚æ•°è¯´æ˜

#### 5.4.1 nodes/planner.py

```python
TARGET_TOTAL_ITEMS = 50      # æ”¶é›†ç›®æ ‡ (æ¡)
MAX_PLAN_STEPS = 50          # æœ€å¤§è§„åˆ’æ­¥æ•°
AUTO_MONITOR_LIMIT = 2       # æ¯å¹³å°è‡ªåŠ¨ç›‘æ§æ¬¡æ•°
```

**è°ƒæ•´å»ºè®®**:
- åˆæœŸæµ‹è¯•: `TARGET = 20`, `MAX_STEPS = 30`
- æ­£å¼è¿è¡Œ: `TARGET = 50-100`, `MAX_STEPS = 50-80`

#### 5.4.2 nodes/executor.py

```python
DEFAULT_PARAMS = {
    "youtube_search": {"limit": 15, "days": 30},
    "bilibili_search": {"limit": 15, "days": 30, "fetch_size": 100},
    # ...
}
```

**è°ƒæ•´å»ºè®®**:
- `limit`: æ¯æ¬¡æœç´¢è¿”å›æ•°é‡ (15æ˜¯è¾ƒå¥½çš„å¹³è¡¡ç‚¹)
- `days`: æ—¶é—´èŒƒå›´ (30å¤©ç¡®ä¿æ–°é²œåº¦)
- `fetch_size` (Bilibili): æ™ºèƒ½åˆ†é¡µçš„æœ€å¤§é¡µæ•°

#### 5.4.3 nodes/filter.py

```python
# å¼•æ“1ç­›é€‰é˜ˆå€¼
VERTICAL_RATIO_THRESHOLD = 1.2   # æ¯”åšä¸»å¹³å‡å¥½20%

# å¼•æ“2ç­›é€‰é˜ˆå€¼
HORIZONTAL_VIEW_MULTIPLIER = 1.5 # æ’­æ”¾é‡è¶…ä¸­ä½æ•°1.5å€
ENGAGEMENT_RATE_THRESHOLD = 0.01 # äº’åŠ¨ç‡1%

# æ—¶æ•ˆæ€§
MONITOR_TIME_WINDOW = 7          # å¼•æ“1: 7å¤©
HUNTER_TIME_WINDOW = 30          # å¼•æ“2: 30å¤©
```

**è°ƒæ•´å»ºè®®**:
- å¦‚æœç­›é€‰ç»“æœå¤ªå°‘: é™ä½é˜ˆå€¼ (1.2 â†’ 1.1, 1.5 â†’ 1.3)
- å¦‚æœç­›é€‰ç»“æœå¤ªå¤š: æé«˜é˜ˆå€¼

#### 5.4.4 tools/youtube_scout.py

```python
# ä¸‰é˜¶æ®µå‚æ•°
STAGE1_MULTIPLIER = 3    # å¿«é€Ÿæ‰«ææ•°é‡ = limit * 3
TOP_N_ENRICH = 15        # è¯¦ç»†æå–æ•°é‡

# çˆ†æ¬¾è¯„åˆ†æƒé‡
FRESHNESS_WEIGHTS = {
    3: 1.5,   # â‰¤3å¤©: 1.5å€
    7: 1.2,   # â‰¤7å¤©: 1.2å€
    14: 1.0,  # â‰¤14å¤©: 1.0å€
    999: 0.8  # >14å¤©: 0.8å€
}

# é¢‘é“è´¨é‡é˜ˆå€¼
CHANNEL_QUALITY_THRESHOLD = 5.0
```

---

## 6. æ•°æ®æµä¸çŠ¶æ€ç®¡ç†

### 6.1 å®Œæ•´æ•°æ®æµå›¾

```
ç”¨æˆ·è¾“å…¥
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RadarState åˆå§‹åŒ–                                        â”‚
â”‚ - target_domains: ["AI News"]                           â”‚
â”‚ - session_focus: {"priority_topics": ["nano banana"]}  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Keyword Designer                                        â”‚
â”‚ LLMè®¾è®¡æœç´¢è¯                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
state.discovery_queries = [
  "best AI News channels 2025",
  "é¡¶çº§AIåšä¸»æ¨è 2025"
]
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Planner (ç¬¬1æ¬¡)                                         â”‚
â”‚ å†³ç­–: web_search("best AI News channels 2025")         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Executor                                                â”‚
â”‚ æ‰§è¡Œweb_search â†’ è¿”å›15ç¯‡æ–‡ç«                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
state.leads = [
  LeadItem(title="Top 10 AI Channels", url="...", tags=["Matt Wolfe"]),
  ...
]
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Routeræ£€æµ‹: leadså­˜åœ¨ && discovered_influencersä¸ºç©º      â”‚
â”‚ â†’ è·³è½¬åˆ° Influencer Extractor                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Influencer Extractor                                    â”‚
â”‚ LLMä»æ–‡ç« ä¸­æå–åšä¸»                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
state.discovered_influencers = [
  {"name": "Matt Wolfe", "platform": "youtube", "identifier": "@mreflow"},
  {"name": "AI Explained", "platform": "youtube", ...},
  ...
]
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Planner (ç¬¬2æ¬¡)                                         â”‚
â”‚ _deterministic_plan: é¡ºè—¤æ‘¸ç“œ                            â”‚
â”‚ å†³ç­–: youtube_search("Matt Wolfe AI News")              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Executor                                                â”‚
â”‚ ä¸‰é˜¶æ®µæœç´¢: æ‰«æ45æ¡ â†’ çˆ†æ¬¾è¯„åˆ† â†’ æå–Top 15              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
state.candidates = [
  ContentItem(title="50+ Ways Nano Banana", views=350000,
              viral_score=9.96, author_avg_views=150000),
  ...
]
  â†“
... (ç»§ç»­æ”¶é›†,ç›´åˆ° len(candidates) >= 50)
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Filter                                                  â”‚
â”‚ å»é‡ 60â†’19 â†’ ç­›é€‰ â†’ Top 10                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
state.filtered_candidates = [
  ContentItem(score=95.2, engine="å¼•æ“1-é¡ºè—¤æ‘¸ç“œ"),
  ...
]
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Architect                                               â”‚
â”‚ LLMç”Ÿæˆé€‰é¢˜ç­–åˆ’                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
state.proposals = [
  TopicBrief(title="Nano Bananaæ·±åº¦æµ‹è¯„", core_angle="..."),
  ...
]
  â†“
è¾“å‡ºç»™ç”¨æˆ·
```

### 6.2 çŠ¶æ€å­—æ®µä¾èµ–å…³ç³»

```
target_domains
      â†“
  (Keyword Designer)
      â†“
discovery_queries, content_queries
      â†“
  (Planner: web_search)
      â†“
    leads
      â†“
  (Influencer Extractor)
      â†“
discovered_influencers
      â†“
  (Planner: é¡ºè—¤æ‘¸ç“œ)
      â†“
searched_influencers (å»é‡ç”¨)
      â†“
  (Executor: youtube_search)
      â†“
  candidates
      â†“
    (Filter)
      â†“
filtered_candidates
      â†“
  (Architect)
      â†“
  proposals
```

---

## 7. å·¥å…·ç³»ç»Ÿ

### 7.1 å·¥å…·æ³¨å†Œæœºåˆ¶

**æ ¸å¿ƒè®¾è®¡**: æ‰€æœ‰å·¥å…·é€šè¿‡ `ToolRegistry` ç»Ÿä¸€ç®¡ç†

```python
# tools/tool_loader.py
from core.tool_registry import registry

def load_tools_from_config():
    # YouTubeæœç´¢
    registry.register(
        name="youtube_search",
        description="Search YouTube videos by keyword with viral filtering",
        input_model=YouTubeSearchInput,
        func=youtube_search_wrapper,
        capabilities=["video_search", "youtube"]
    )

    # Bilibiliæœç´¢
    registry.register(
        name="bilibili_search",
        description="Search Bilibili videos with smart pagination",
        input_model=BilibiliSearchInput,
        func=bilibili_search_wrapper,
        capabilities=["video_search", "bilibili"]
    )

    # ... å…¶ä»–å·¥å…·
```

**Wrapperæ¨¡å¼**:

```python
def youtube_search_wrapper(args: Dict[str, Any]) -> ToolResult:
    """
    å·¥å…·Wrapper: ç»Ÿä¸€è¾“å…¥/è¾“å‡ºæ ¼å¼
    """
    try:
        # éªŒè¯è¾“å…¥
        input_data = YouTubeSearchInput(**args)

        # æ‰§è¡ŒçœŸå®å·¥å…·
        scout = YouTubeScout()
        videos = scout.search_videos(
            keyword=input_data.keyword,
            limit=input_data.limit,
            days=input_data.days
        )

        # è¿”å›æ ‡å‡†ToolResult
        return ToolResult(
            status="success",
            data=videos,
            summary=f"Found {len(videos)} videos for '{input_data.keyword}'"
        )
    except Exception as e:
        return ToolResult(
            status="error",
            data=None,
            summary="",
            error=str(e)
        )
```

### 7.2 YouTube Scout (ä¸‰é˜¶æ®µçˆ†æ¬¾ç­›é€‰)

**æ–‡ä»¶**: `tools/youtube_scout.py`

**è®¾è®¡ç†å¿µ**: ä¸æ˜¯"è¶Šå¤šè¶Šå¥½",è€Œæ˜¯"ç²¾å‡†çˆ†æ¬¾"

**ä¸‰é˜¶æ®µæµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜¶æ®µ1: å¿«é€Ÿæ‰«æ (Fast Scan)                            â”‚
â”‚ - ä½¿ç”¨ --flat-playlist å¿«é€Ÿè·å–å…ƒæ•°æ®                  â”‚
â”‚ - æ‰«ææ•°é‡ = limit Ã— 3 (ä¾‹å¦‚ 15 Ã— 3 = 45æ¡)            â”‚
â”‚ - åªè·å– view_count, duration ç­‰åŸºç¡€å­—æ®µ                â”‚
â”‚ - æˆæœ¬ä½, é€Ÿåº¦å¿«                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜¶æ®µ2: çˆ†æ¬¾è¯„åˆ† (Viral Scoring)                        â”‚
â”‚ - è®¡ç®—æ¯ä¸ªè§†é¢‘çš„ viral_score                            â”‚
â”‚ - viral_score = view_ratio Ã— freshness Ã— duration_weightâ”‚
â”‚ - view_ratio = view_count / author_avg_views           â”‚
â”‚ - freshness = 1.5 (â‰¤3å¤©), 1.2 (â‰¤7å¤©), ...              â”‚
â”‚ - æ’åº,é€‰å‡º Top N                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜¶æ®µ3: è¯¦ç»†æå– (Detail Enrichment)                    â”‚
â”‚ - åªå¯¹ Top 15 ä½¿ç”¨ yt_dlp Python API                    â”‚
â”‚ - è·å–å®Œæ•´æ•°æ®: like_count, comment_count, description  â”‚
â”‚ - æˆæœ¬é›†ä¸­åœ¨é«˜è´¨é‡å†…å®¹ä¸Š                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**çˆ†æ¬¾è¯„åˆ†ç®—æ³•**:

```python
def _score_and_rank_viral(self, videos, days=30):
    for video in videos:
        # 1. æ’­æ”¾æ¯”ç‡ (ä¸åšä¸»å¹³å‡æ¯”)
        avg_views = video.get('author_avg_views', 100000)
        view_ratio = video['view_count'] / max(avg_views, 1)

        # 2. æ—¶æ•ˆæ€§è¡°å‡
        days_old = (datetime.now() - upload_date).days
        if days_old <= 3:
            freshness = 1.5
        elif days_old <= 7:
            freshness = 1.2
        elif days_old <= 14:
            freshness = 1.0
        else:
            freshness = 0.8

        # 3. æ—¶é•¿æƒé‡ (3-20åˆ†é’Ÿæœ€ä½³)
        duration_min = video['duration'] / 60
        if 3 <= duration_min <= 20:
            duration_weight = 1.2
        elif duration_min < 1:
            duration_weight = 0.5
        else:
            duration_weight = 0.8

        # ç»¼åˆåˆ†æ•°
        viral_score = view_ratio * freshness * duration_weight
        video['viral_score'] = viral_score

    # æ’åº
    return sorted(videos, key=lambda x: x['viral_score'], reverse=True)
```

**ç¤ºä¾‹è¾“å‡º**:

```json
[
  {
    "title": "50+ Ways To Use Nano Banana",
    "url": "https://youtube.com/watch?v=xxx",
    "view_count": 350000,
    "author_avg_views": 150000,
    "viral_score": 9.96,
    "duration": 1200,
    "upload_date": "20251120",
    "likes": 8500,
    "comments": 320
  }
]
```

### 7.3 Bilibili Adapter (æ™ºèƒ½åˆ†é¡µ)

**æ–‡ä»¶**: `tools/adapters/bilibili_adapter.py`

**æ ¸å¿ƒåˆ›æ–°**: æ™ºèƒ½åœæ­¢åˆ†é¡µ (èŠ‚çœAPIè°ƒç”¨)

**æ™ºèƒ½åˆ†é¡µé€»è¾‘**:

```python
def _smart_pagination(self, keyword, order_type, target_count=50):
    """
    æ™ºèƒ½åˆ†é¡µ: å½“å†…å®¹è´¨é‡ä¸‹é™æ—¶è‡ªåŠ¨åœæ­¢
    """
    collected = []
    current_page = 1
    max_pages = 10
    last_avg_views = float('inf')

    while len(collected) < target_count and current_page <= max_pages:
        # è·å–å½“å‰é¡µ
        results = sync(search.search_by_type(
            keyword=keyword,
            page=current_page,
            page_size=20,
            order_type=order_type
        ))

        page_videos = results.get('result', [])
        if not page_videos:
            break

        # è®¡ç®—æœ¬é¡µå¹³å‡æ’­æ”¾é‡
        views = [v.get('play', 0) for v in page_videos]
        current_avg = statistics.mean(views)

        # ğŸ”‘ è´¨é‡æ£€æŸ¥: å¦‚æœæœ¬é¡µå¹³å‡æ’­æ”¾é‡ < ä¸Šä¸€é¡µ * 0.4,åœæ­¢
        if current_avg < last_avg_views * 0.4:
            print(f"ğŸ“‰ æ’­æ”¾é‡ä¸‹é™ {current_avg} < {last_avg_views*0.4}, åœæ­¢åˆ†é¡µ")
            break

        collected.extend(page_videos)
        last_avg_views = current_avg
        current_page += 1

    return collected
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡?**

Bç«™æœç´¢ç»“æœæŒ‰"ç»¼åˆæ’åº"æ—¶:
- å‰å‡ é¡µ: é«˜è´¨é‡å†…å®¹ (æ’­æ”¾é‡é«˜)
- åå‡ é¡µ: è´¨é‡ä¸‹é™æ˜æ˜¾

é€šè¿‡ç›‘æ§**é¡µé—´æ’­æ”¾é‡å˜åŒ–**,å¯ä»¥:
- è‡ªåŠ¨åœåœ¨"è´¨é‡é™¡é™"ç‚¹
- é¿å…æ”¶é›†ä½è´¨é‡å†…å®¹
- èŠ‚çœAPIè°ƒç”¨

**å®é™…æ•ˆæœ**:
- ç›®æ ‡50æ¡,æœ€å¤§10é¡µ
- å®é™…è¿è¡Œ: 3-4é¡µå°±åœæ­¢
- æ•ˆç‡æå‡ 60%+

---

## 8. è¿è¡Œæµç¨‹ç¤ºä¾‹

### 8.1 æ­£å¸¸è¿è¡Œæµç¨‹

**ç”¨æˆ·è¾“å…¥**:
```bash
$ python main.py

æœ¬è½®ä¼˜å…ˆå…³æ³¨å“ªäº›ä¸»é¢˜? AI nano banana
ä¼˜å…ˆé‡‡é›†çš„å¹³å°?
æ˜¯å¦æœ‰ç‰¹åˆ«æƒ³è·Ÿçš„ä½œè€…/é¢‘é“?
æœ¬è½®æƒ³é‡ç‚¹è§‚å¯Ÿå“ªäº›æŒ‡æ ‡?
```

**ç³»ç»Ÿæ‰§è¡Œ** (å¸¦è¯¦ç»†æ—¥å¿—):

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  é˜¶æ®µ1: æœç´¢è¯è®¾è®¡                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

--- èŠ‚ç‚¹: æœç´¢è¯è®¾è®¡å¸ˆ (Node: Keyword Designer) ---
âœ… æœç´¢è¯è®¾è®¡å®Œæˆ:
   å‘ç°åšä¸»: 5 æ¡
      - best AI News YouTube channels 2025
      - é¡¶çº§AIåšä¸»æ¨è 2025
      - ...
   æœç´¢å†…å®¹: 5 æ¡
      - AI nano banana 2025-11
      - ...

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ”´ å¼•æ“1 - é˜¶æ®µ2: å‘ç°åšä¸»                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

--- èŠ‚ç‚¹: è§„åˆ’å¤§è„‘ (Node: Planner) ---
ğŸ“Š å½“å‰è¿›åº¦: å·²æ”¶é›† 0/50 æ¡
ğŸ§  æ€è€ƒ: discovery_querieså·²è®¾è®¡ä½†Webæœç´¢æœªæ‰§è¡Œ,
        éœ€è¦ç«‹å³æœç´¢ç¬¬ä¸€ä¸ªå…³é”®è¯æ‰¾åˆ°åšä¸»æ¨èæ–‡ç« 
ğŸ‘‰ å†³ç­–: è°ƒç”¨ web_search

--- èŠ‚ç‚¹: æ‰§è¡Œä¹‹æ‰‹ (Node: Executor) ---
ğŸ”¨ æ‰§è¡Œ: web_search("best AI News YouTube channels 2025")
âœ… ç»“æœ: Found 15 results

ğŸ”„ æ£€æµ‹åˆ° Web æœç´¢ç»“æœï¼Œå‡†å¤‡æå–åšä¸»...

--- èŠ‚ç‚¹: åšä¸»æå–å™¨ (Node: Influencer Extractor) ---
âœ… åšä¸»æå–å®Œæˆ:
   åˆ†ææ–‡ç« æ•°: 15
   å‘ç°åšä¸»æ•°: 8 (å»é‡å)
   YouTube åšä¸» (6):
      - Matt Wolfe (@mreflow) [æåŠ4æ¬¡, ç½®ä¿¡åº¦: high]
      - AI Explained [æåŠ2æ¬¡, ç½®ä¿¡åº¦: high]
      - ...
   Bilibili UPä¸» (2):
      - ææ°¸ä¹è€å¸ˆ [ç½®ä¿¡åº¦: high]
      - ...

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ”´ å¼•æ“1 - é˜¶æ®µ3: é¡ºè—¤æ‘¸ç“œ                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

--- èŠ‚ç‚¹: è§„åˆ’å¤§è„‘ (Node: Planner) ---
ğŸ“Š å½“å‰è¿›åº¦: å·²æ”¶é›† 0/50 æ¡
ğŸ§  è§„åˆ’å™¨: é¡ºè—¤æ‘¸ç“œï¼šæœç´¢é¡¶çº§åšä¸» Matt Wolfe çš„ AI News ç›¸å…³å†…å®¹
ğŸ‘‰ å†³ç­–: è°ƒç”¨ youtube_search

--- èŠ‚ç‚¹: æ‰§è¡Œä¹‹æ‰‹ (Node: Executor) ---
ğŸ”¨ æ‰§è¡Œ: youtube_search...
ğŸ” [YouTube] ä¸‰é˜¶æ®µæœç´¢: Matt Wolfe AI News
ğŸ“„ [é˜¶æ®µ1] å¿«é€Ÿæ‰«æ 45 æ¡...
âœ… [é˜¶æ®µ1] æ‰«æåˆ° 45 æ¡åŸºç¡€æ•°æ®
ğŸ¯ [é˜¶æ®µ2] è®¡ç®—çˆ†æ¬¾åˆ†...
   Top 3 çˆ†æ¬¾åˆ†: 9.96, 8.52, 7.31
âœ… [é˜¶æ®µ2] æ’åºå®Œæˆï¼Œtop 15 çˆ†æ¬¾è¯†åˆ«
ğŸ“Š [é˜¶æ®µ3] æå– top 15 è¯¦ç»†ä¿¡æ¯...
   æå–è¯¦æƒ… 1/15: 50+ INSANE Ways To Use Nano Banana...
   ...
âœ… [YouTube] å®Œæˆï¼è¿”å› 15 æ¡çˆ†æ¬¾å†…å®¹
ğŸ“¥ å…¥åº“: 15 æ¡æ•°æ®

... (ç»§ç»­æ”¶é›†å…¶ä»–åšä¸»)

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ”µ å¼•æ“2 - å…³é”®è¯æœç´¢                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

--- èŠ‚ç‚¹: è§„åˆ’å¤§è„‘ (Node: Planner) ---
ğŸ§  æ€è€ƒ: YouTubeå¹³å°å·²æœç´¢,ä¸ºä¿æŒå¹³å°å¹³è¡¡,
        ä¸‹ä¸€æ­¥åº”è¯¥æ‰§è¡ŒBilibiliæœç´¢
ğŸ‘‰ å†³ç­–: è°ƒç”¨ bilibili_search

--- èŠ‚ç‚¹: æ‰§è¡Œä¹‹æ‰‹ (Node: Executor) ---
ğŸ”¨ æ‰§è¡Œ: bilibili_search("AI nano banana")
ğŸ” [Bilibili] æ™ºèƒ½åˆ†é¡µæœç´¢...
ğŸ“„ ç¬¬1é¡µ: 20æ¡, å¹³å‡æ’­æ”¾ 85000
ğŸ“„ ç¬¬2é¡µ: 20æ¡, å¹³å‡æ’­æ”¾ 62000
ğŸ“‰ ç¬¬3é¡µ: å¹³å‡æ’­æ”¾ 25000 < 62000*0.4, åœæ­¢åˆ†é¡µ
âœ… [Bilibili] å®Œæˆï¼è¿”å› 40 æ¡
ğŸ“¥ å…¥åº“: 40 æ¡æ•°æ®

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  æ”¶é›†å®Œæˆ                                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

--- èŠ‚ç‚¹: è§„åˆ’å¤§è„‘ (Node: Planner) ---
ğŸ“Š å½“å‰è¿›åº¦: å·²æ”¶é›† 55/50 æ¡
ğŸ§  è§„åˆ’å®Œæˆ: å·²æ”¶é›† 55 æ¡ç´ æï¼Œå‡†å¤‡è¿›å…¥ç­›é€‰ã€‚

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  æ™ºèƒ½ç­›é€‰                                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

--- èŠ‚ç‚¹: æ™ºèƒ½ç­›é€‰ (Node: Filter) ---
ğŸ“Š å»é‡: 55 â†’ 42 æ¡
ğŸ“Š æ•°æ®åˆ†ç±»:
   ğŸ”´ å¼•æ“1 (é¡ºè—¤æ‘¸ç“œ): 15 æ¡
   ğŸ”µ å¼•æ“2 (å…³é”®è¯æœç´¢): 27 æ¡

ğŸ”´ å¼•æ“1ç­›é€‰ (çºµå‘å¼‚å¸¸æ£€æµ‹):
   âœ… "50+ Ways Nano Banana" - æ¯”åšä¸»å¹³å‡å¥½2.3å€ â†’ åˆ†æ•°95.2
   âœ… "AI News Weekly" - æ¯”åšä¸»å¹³å‡å¥½1.8å€ â†’ åˆ†æ•°88.0
   ... (å…±8æ¡é€šè¿‡)

ğŸ”µ å¼•æ“2ç­›é€‰ (æ¨ªå‘å¯¹æ¯”):
   âœ… "Nano Bananaæ·±åº¦è¯„æµ‹" - æ’­æ”¾é‡æ˜¯ä¸­ä½æ•°2.1å€ â†’ åˆ†æ•°72.5
   ... (å…±5æ¡é€šè¿‡)

ğŸ§¹ æ™ºèƒ½ç­›é€‰å®Œæˆ: ä» 42 æ¡ä¸­ç²¾é€‰ 13 æ¡å¼‚å¸¸ä¼˜è´¨å†…å®¹ã€‚

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  é€‰é¢˜ç­–åˆ’                                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

--- èŠ‚ç‚¹: é€‰é¢˜ç­–åˆ’ (Node: Architect) ---
âœ… ç”Ÿæˆ 5 ä¸ªé€‰é¢˜ç­–åˆ’

[ç²¾é€‰é€‰é¢˜ç®€æŠ¥]

ğŸ“„ é€‰é¢˜ #1
æ ‡é¢˜: Nano Banana æ·±åº¦æµ‹è¯„: AIå·¥å…·çš„ä¸‹ä¸€ä¸ªé£å£?
åˆ‡å…¥ç‚¹: ä»Matt Wolfeçš„50+ç”¨æ³•è§†é¢‘ä¸­,æç‚¼å‡º3ä¸ªæœ€æœ‰å®æˆ˜ä»·å€¼çš„åœºæ™¯,
        é¿å¼€æ³›æ³›çš„åŠŸèƒ½ä»‹ç»
æ¨èç†ç”±: è¯¥è§†é¢‘çˆ†æ¬¾åˆ†9.96,è¿œè¶…åšä¸»å¹³å‡æ°´å¹³ã€‚è¯´æ˜Nano Bananaç¡®å®
         å¼•èµ·äº†å¼ºçƒˆå…³æ³¨ã€‚æˆ‘ä»¬çš„åˆ‡å…¥ç‚¹èšç„¦"å®æˆ˜åœºæ™¯",åŒºåˆ«äºç«å“ã€‚
æ¥æºç­–ç•¥: viral_hit (å¼•æ“1-é¡ºè—¤æ‘¸ç“œ)

ğŸ“„ é€‰é¢˜ #2
æ ‡é¢˜: å›½å†…é¦–æµ‹: Nano Banana vs é€šä¹‰çµç ,è°æ›´é€‚åˆä¸­æ–‡å¼€å‘è€…?
åˆ‡å…¥ç‚¹: æ¨ªå‘å¯¹æ¯”æµ‹è¯„,ä¸“æ³¨ä¸­æ–‡åœºæ™¯
æ¨èç†ç”±: Bç«™æœç´¢å‘ç°"Nano Bananaæ·±åº¦è¯„æµ‹"æ’­æ”¾é‡æ˜¯åŒè¡Œ2.1å€,
         è¯´æ˜å›½å†…ç”¨æˆ·å¯¹æ­¤å·¥å…·æœ‰å¼ºçƒˆå…´è¶£,ä½†ç¼ºå°‘ä¸­æ–‡æ·±åº¦å†…å®¹ã€‚
æ¥æºç­–ç•¥: competitor (å¼•æ“2-å…³é”®è¯æœç´¢)

... (æ›´å¤šé€‰é¢˜)
```

---

## 9. è°ƒè¯•ä¸ä¼˜åŒ–æŒ‡å—

### 9.1 æ—¥å¿—åˆ†æ

**å…³é”®æ—¥å¿—æ ‡è¯†**:

| æ ‡è¯† | å«ä¹‰ |
|------|------|
| `ğŸ”´` | å¼•æ“1ç›¸å…³ |
| `ğŸ”µ` | å¼•æ“2ç›¸å…³ |
| `ğŸ“Š` | è¿›åº¦/ç»Ÿè®¡æ•°æ® |
| `ğŸ§ ` | Planneræ€è€ƒè¿‡ç¨‹ |
| `ğŸ‘‰` | Plannerå†³ç­– |
| `ğŸ”¨` | å·¥å…·æ‰§è¡Œ |
| `âœ…` | æˆåŠŸ |
| `âŒ` | é”™è¯¯ |
| `âš ï¸` | è­¦å‘Š |

**è°ƒè¯•æŠ€å·§**:

1. **æ£€æŸ¥Plannerå†³ç­–é“¾**
   ```
   æœç´¢æ—¥å¿—ä¸­çš„ "ğŸ§  æ€è€ƒ" å’Œ "ğŸ‘‰ å†³ç­–"
   ç¡®è®¤Plannerçš„æ¨ç†æ˜¯å¦åˆç†
   ```

2. **æ£€æŸ¥æ•°æ®æµè½¬**
   ```
   discovery_queries â†’ leads â†’ discovered_influencers â†’ candidates
   æ¯ä¸ªé˜¶æ®µéƒ½åº”è¯¥æœ‰æ˜ç¡®çš„æ—¥å¿—è¾“å‡º
   ```

3. **æ£€æŸ¥ç­›é€‰é€»è¾‘**
   ```
   çœ‹ "ğŸ“Š æ•°æ®åˆ†ç±»" çš„åˆ†å¸ƒ
   å¦‚æœå…¨æ˜¯å¼•æ“2,è¯´æ˜å¼•æ“1æ²¡æœ‰æ­£å¸¸å·¥ä½œ
   ```

### 9.2 å¸¸è§æ€§èƒ½ç“¶é¢ˆ

#### ç“¶é¢ˆ1: LLMè°ƒç”¨è¿‡å¤š

**ç—‡çŠ¶**: è¿è¡Œç¼“æ…¢,æˆæœ¬é«˜

**åˆ†æ**:
```python
# ç»Ÿè®¡LLMè°ƒç”¨æ¬¡æ•°
LLMè°ƒç”¨ç‚¹:
- Keyword Designer: 1æ¬¡
- Planner: æ¯æ¬¡è§„åˆ’1æ¬¡ (å¯èƒ½5-10æ¬¡)
- Influencer Extractor: 1æ¬¡
- Architect: 1æ¬¡

æ€»è®¡: çº¦ 10-15 æ¬¡LLMè°ƒç”¨
```

**ä¼˜åŒ–**:
1. ä½¿ç”¨ä¾¿å®œçš„æ¨¡å‹ (DeepSeek) åšPlanner
2. å‡å°‘Plannerå¾ªç¯æ¬¡æ•° (è°ƒæ•´TARGET_TOTAL_ITEMS)
3. ç¼“å­˜Keyword Designerç»“æœ

#### ç“¶é¢ˆ2: å·¥å…·è°ƒç”¨é‡å¤

**ç—‡çŠ¶**: é‡å¤æœç´¢åŒä¸€ä¸ªå…³é”®è¯/åšä¸»

**æ’æŸ¥**:
```bash
# åœ¨æ—¥å¿—ä¸­æœç´¢
grep "ğŸ‘‰ å†³ç­–" output.log | sort | uniq -c

# å¦‚æœçœ‹åˆ°:
4 ğŸ‘‰ å†³ç­–: è°ƒç”¨ youtube_search (Matt Wolfe)
# è¯´æ˜æœ‰é‡å¤
```

**ä¿®å¤**: è§ç¬¬10èŠ‚ "å¸¸è§é—®é¢˜æ’æŸ¥"

#### ç“¶é¢ˆ3: YouTube APIé™é€Ÿ

**ç—‡çŠ¶**: yt-dlpæŠ¥é”™ "Too many requests"

**è§£å†³**:
1. é™ä½ `DEFAULT_PARAMS` ä¸­çš„ `limit`
2. å¢åŠ ä¸¤æ¬¡æœç´¢ä¹‹é—´çš„å»¶è¿Ÿ
3. ä½¿ç”¨ä»£ç† (åœ¨ `youtube_scout.py` ä¸­é…ç½®)

### 9.3 æˆæœ¬ä¼˜åŒ–

**æ¨¡å‹æˆæœ¬å¯¹æ¯”** (OpenRouterå®šä»·):

| æ¨¡å‹ | è¾“å…¥æˆæœ¬ ($/1M tokens) | è¾“å‡ºæˆæœ¬ | é€‚ç”¨åœºæ™¯ |
|------|----------------------|---------|---------|
| DeepSeek-R1 | $0.55 | $2.19 | Planner (æ¨ç†ä»»åŠ¡) |
| DeepSeek-Chat | $0.14 | $0.28 | å¿«é€Ÿä»»åŠ¡ |
| Claude Sonnet 3.5 | $3.00 | $15.00 | åˆ›æ„ä»»åŠ¡ (ç­–åˆ’) |

**å•æ¬¡è¿è¡Œæˆæœ¬ä¼°ç®—**:

```
Keyword Designer (DeepSeek-R1):
  è¾“å…¥: ~1K tokens, è¾“å‡º: ~500 tokens
  æˆæœ¬: $0.001

Planner Ã— 10æ¬¡ (DeepSeek-R1):
  æ¯æ¬¡: è¾“å…¥~2K, è¾“å‡º~200
  æ€»æˆæœ¬: $0.015

Influencer Extractor (Claude Sonnet):
  è¾“å…¥: ~5K tokens, è¾“å‡º: ~1K tokens
  æˆæœ¬: $0.03

Architect (Claude Sonnet):
  è¾“å…¥: ~3K tokens, è¾“å‡º: ~2K tokens
  æˆæœ¬: $0.04

æ€»è®¡: çº¦ $0.086 (ä¸åˆ°1æ¯›é’±)
```

**ä¼˜åŒ–å»ºè®®**:
1. å°½é‡ç”¨DeepSeekæ›¿ä»£Claude (æˆæœ¬é™ä½10å€)
2. åªåœ¨å¿…è¦æ—¶ç”¨Claude (Influencer Extractor, Architect)

---

## 10. å¸¸è§é—®é¢˜æ’æŸ¥

### 10.1 é—®é¢˜: Bilibiliå®Œå…¨æ²¡æœ‰æ•°æ®

**ç—‡çŠ¶**:
```
ğŸ“Š å¾…ç›‘æ§é˜Ÿåˆ—: YouTube=2, Bilibili=0
```

**åŸå› **:
1. Keyword Designer ç”Ÿæˆäº†ä¸­æ–‡æœç´¢è¯,ä½†åªæœç´¢äº†ç¬¬ä¸€ä¸ª (è‹±æ–‡)
2. Plannerè¢«"é¡ºè—¤æ‘¸ç“œ"ç»‘æ¶,ä¸€ç›´æœç´¢YouTubeåšä¸»

**æ’æŸ¥**:
```bash
# æ£€æŸ¥discovery_queries
grep "discovery_queries" output.log

# æ£€æŸ¥web_searchè°ƒç”¨
grep "web_search" output.log | wc -l
# å¦‚æœåªæœ‰1æ¬¡,è¯´æ˜åªæœç´¢äº†ç¬¬ä¸€ä¸ªquery
```

**ä¿®å¤æ–¹æ¡ˆA**: æœç´¢å¤šä¸ªdiscovery_queries

ä¿®æ”¹ `planner.py`:
```python
# æ·»åŠ çŠ¶æ€å­—æ®µ
web_search_count: int = 0

# åœ¨ç¡®å®šæ€§é€»è¾‘ä¸­
if state.web_search_count < min(3, len(state.discovery_queries)):
    query = state.discovery_queries[state.web_search_count]
    state.web_search_count += 1
    return ("web_search", {"query": query}, f"Webæœç´¢: {query}")
```

### 10.2 é—®é¢˜: é‡å¤æœç´¢åŒä¸€ä¸ªåšä¸»

**ç—‡çŠ¶**:
```
ğŸ‘‰ å†³ç­–: è°ƒç”¨ youtube_search (Matt Wolfe AI News) Ã— 4
```

**åŸå› **: Influencer Extractoræœªå»é‡,ç”Ÿæˆäº†4ä¸ª"Matt Wolfe"

**æ’æŸ¥**:
```python
# æ£€æŸ¥discovered_influencers
print([inf['name'] for inf in state.discovered_influencers])
# å¦‚æœçœ‹åˆ°: ['Matt Wolfe', 'Matt Wolfe', 'Matt Wolfe', ...]
```

**ä¿®å¤**: åœ¨ `influencer_extractor.py` æ·»åŠ å»é‡

```python
def _deduplicate_influencers(influencers: List[InfluencerInfo]) -> List[InfluencerInfo]:
    deduped = {}
    for inf in influencers:
        # è§„èŒƒåŒ–key
        key = f"{inf.platform}:{inf.identifier.lower()}"
        if not inf.identifier:
            key = f"{inf.platform}:{inf.name.lower()}"

        if key in deduped:
            # åˆå¹¶
            deduped[key].mention_count += inf.mention_count
            if inf.confidence == "high":
                deduped[key].confidence = "high"
        else:
            deduped[key] = inf

    return list(deduped.values())

# åœ¨run_influencer_extractorä¸­è°ƒç”¨
sorted_influencers = sorted(result.influencers, ...)
sorted_influencers = _deduplicate_influencers(sorted_influencers)  # ğŸ”‘ æ–°å¢
```

### 10.3 é—®é¢˜: ç­›é€‰å™¨è¿‡æ»¤æ‰æ‰€æœ‰å†…å®¹

**ç—‡çŠ¶**:
```
ğŸ§¹ æ™ºèƒ½ç­›é€‰å®Œæˆ: ä» 19 æ¡ä¸­ç²¾é€‰ 0 æ¡
```

**åŸå› **: ç­›é€‰æ ‡å‡†ä¸åŒ¹é…æ•°æ®æ¥æº

**æ’æŸ¥**:
```python
# æ£€æŸ¥æ•°æ®åˆ†ç±»
for item in state.candidates:
    print(f"{item.source_type}: {item.view_count}, avg={item.author_avg_views}")

# å¦‚æœçœ‹åˆ°:
# youtube_search: 200000, avg=150000  (æ¯”å¹³å‡å¥½1.33å€)
# youtube_search: 180000, avg=150000  (æ¯”å¹³å‡å¥½1.2å€)
# ...

# ä½†ä¸­ä½æ•° = 190000
# éœ€è¦ > 190000 * 1.5 = 285000 æ‰èƒ½é€šè¿‡
# ç»“æœ: 0æ¡é€šè¿‡
```

**ä¿®å¤**: æ ‡è®°æ•°æ®æ¥æº

1. ä¿®æ”¹ `planner.py`:
```python
# åœ¨é¡ºè—¤æ‘¸ç“œæ—¶æ·»åŠ æ ‡è®°
return (
    "youtube_search",
    {
        "keyword": keyword,
        "from_influencer": influencer.identifier,  # ğŸ”‘ æ–°å¢
        "influencer_name": influencer.name
    },
    reasoning
)
```

2. ä¿®æ”¹ `executor.py`:
```python
if tool_name in ["youtube_search", "bilibili_search"]:
    if tool_args.get("from_influencer"):
        ci.raw_data["from_influencer_search"] = True
        ci.raw_data["source_influencer"] = tool_args.get("influencer_name")
```

3. ä¿®æ”¹ `filter.py`:
```python
# ä¿®æ”¹åˆ†ç»„é€»è¾‘
monitor_items = [i for i in state.candidates if
                 i.source_type in ["youtube_monitor", "bilibili_monitor"] or
                 i.raw_data.get("from_influencer_search")]  # ğŸ”‘ æ–°å¢
```

### 10.4 é—®é¢˜: PydanticéªŒè¯é”™è¯¯

**ç—‡çŠ¶**:
```
ValidationError: Input should be a valid dictionary
```

**åŸå› **: èŠ‚ç‚¹è¿”å›äº†Pydanticå¯¹è±¡è€Œä¸æ˜¯å­—å…¸

**ä¿®å¤**: æ‰€æœ‰Pydanticå¯¹è±¡è½¬å­—å…¸
```python
# é”™è¯¯
return {"discovered_influencers": sorted_influencers}

# æ­£ç¡®
return {"discovered_influencers": [inf.model_dump() for inf in sorted_influencers]}
```

---

## ç»“è¯­

è¿™ä»½æ–‡æ¡£è¦†ç›–äº†é€‰é¢˜é›·è¾¾ç³»ç»Ÿçš„æ‰€æœ‰æ ¸å¿ƒæ¦‚å¿µã€ä»£ç ç»“æ„å’Œè¿è¡Œæœºåˆ¶ã€‚

**æ¨èé˜…è¯»é¡ºåº**:
1. ç¬¬1-2èŠ‚: ç†è§£ç³»ç»Ÿå®šä½å’Œè®¾è®¡ç†å¿µ
2. ç¬¬3èŠ‚: æŒæ¡æ•´ä½“æ¶æ„
3. ç¬¬4èŠ‚: é€ä¸ªæ–‡ä»¶æ·±å…¥ç†è§£
4. ç¬¬5-6èŠ‚: é…ç½®å’Œæ•°æ®æµ
5. ç¬¬7-10èŠ‚: å®æˆ˜å’Œæ’é”™

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
1. è¿è¡Œä¸€æ¬¡å®Œæ•´æµç¨‹,å¯¹ç…§æ–‡æ¡£ç†è§£æ—¥å¿—
2. æ ¹æ®ç¬¬10èŠ‚ä¿®å¤å½“å‰é—®é¢˜
3. è°ƒæ•´é…ç½®å‚æ•°,ä¼˜åŒ–æ•ˆæœ
4. æ‰©å±•æ–°åŠŸèƒ½ (å¦‚æ–°å¹³å°, æ–°å·¥å…·)

**è”ç³»æ–¹å¼**:
- é¡¹ç›®é—®é¢˜: æIssueåˆ°é¡¹ç›®ä»“åº“
- æŠ€æœ¯è®¨è®º: è§README

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-26
