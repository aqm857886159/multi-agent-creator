# è°ƒç ”æŠ¥å‘Šï¼šä»"åˆ†ç±»é©±åŠ¨"åˆ°"æ„å›¾é©±åŠ¨"é‡æ„

**æ—¥æœŸ**: 2025-11-28
**è°ƒç ”ç›®æ ‡**: ç†è§£æ•°æ®ç»“æ„ã€è¯†åˆ«é—®é¢˜ã€è®¾è®¡æ„å›¾é©±åŠ¨æ–¹æ¡ˆ

---

## ğŸ“Š Step 1: æ•°æ®ç»“æ„è°ƒç ”

### 1.1 TopicBrief ç»“æ„åˆ†æ

**å®šä¹‰ä½ç½®**: `core/state.py:66-76`

```python
class TopicBrief(BaseModel):
    id: str                              # å”¯ä¸€ID
    title: str                           # é€‰é¢˜æ ‡é¢˜
    core_angle: str                      # ç‹¬ç‰¹åˆ‡å…¥ç‚¹
    rationale: str                       # æ¨èç†ç”±
    source_type: str                     # "viral_hit" | "competitor" | "tech_news" | "search"
    reference_data: List[Dict[str, Any]] # æ”¯æ’‘æ•°æ®ï¼ˆå…³é”®ï¼ï¼‰
```

**å…³é”®å‘ç°**ï¼š
- âœ… `source_type` å­—æ®µå­˜åœ¨ï¼Œè¡¨æ˜é€‰é¢˜æ¥æº
- âœ… `reference_data` æ˜¯åˆ—è¡¨ï¼ŒåŒ…å«å¤šæ¡ç´ æ
- âŒ **å½“å‰ Analyst å®Œå…¨å¿½ç•¥äº† `reference_data`ï¼**

---

### 1.2 reference_data çš„å®é™…å†…å®¹

**ç”Ÿæˆä½ç½®**: `nodes/architect.py:26-42`

**æ•°æ®æ¥æº**: ä» `state.filtered_candidates` æå–ï¼Œæ¯ä¸ªå€™é€‰æ˜¯ `ContentItem`

**ContentItem ç»“æ„** (`core/state.py:5-19`):
```python
class ContentItem(BaseModel):
    platform: str           # youtube, bilibili
    source_type: str        # monitor_kol, keyword_search
    title: str              # è§†é¢‘æ ‡é¢˜
    url: str                # è§†é¢‘é“¾æ¥
    author_name: str        # ä½œè€…å
    author_id: str          # ä½œè€…ID
    author_fans: int        # ç²‰ä¸æ•°
    author_avg_views: int   # å¹³å‡æ’­æ”¾
    publish_time: str       # å‘å¸ƒæ—¶é—´
    view_count: int         # æ’­æ”¾é‡
    interaction: int        # äº’åŠ¨æ•°ï¼ˆç‚¹èµ+è¯„è®º+åˆ†äº«ï¼‰
    score: float            # ç­›é€‰è¯„åˆ†
    raw_data: Dict[str, Any]  # ğŸ”‘ åŸå§‹æ•°æ®ï¼ˆå¯èƒ½åŒ…å«ç®€ä»‹ã€è¯„è®ºï¼‰
```

**æ¨æ–­çš„ reference_data ç»“æ„**:
```python
reference_data: [
    {
        "platform": "bilibili",
        "title": "ç”¨\"2+3+5\"çœŸçš„å¯ä»¥æ€æ­»æ‹–å»¶ç—‡ï¼",
        "url": "https://...",
        "view_count": 119000,
        "author_name": "æŸUPä¸»",
        "raw_data": {
            "description": "è§†é¢‘ç®€ä»‹...",  # ğŸ”‘ å¯èƒ½åŒ…å«
            "summary": "æ‘˜è¦...",          # ğŸ”‘ å¯èƒ½åŒ…å«
            ...
        }
    },
    ...
]
```

**å…³é”®æ´å¯Ÿ**ï¼š
- âœ… **å·²æœ‰ç´ æåŒ…å«ä¸°å¯Œä¿¡æ¯**: æ ‡é¢˜ã€æ’­æ”¾é‡ã€ä½œè€…ã€å¯èƒ½çš„ç®€ä»‹
- âœ… **è¿™äº›ç´ æå·²ç»ç»è¿‡ç­›é€‰**: éƒ½æ˜¯é«˜è´¨é‡ã€ç›¸å…³çš„å†…å®¹
- âŒ **Analyst å½“å‰å®Œå…¨æµªè´¹äº†è¿™äº›ä¿¡æ¯**: é‡æ–°ä»é›¶æœç´¢

---

### 1.3 Architect å¦‚ä½•ç”Ÿæˆ TopicBrief

**ä»£ç ä½ç½®**: `nodes/architect.py:26-64`

**å…³é”®é€»è¾‘**:
```python
# 1. éå† filtered_candidates
for idx, item in enumerate(state.filtered_candidates, 1):
    # 2. æå–ç®€ä»‹ï¼ˆæœ€å¤š3000å­—ç¬¦ï¼‰
    clean_desc = _deep_clean_text(
        item.raw_data.get('description', '') or
        item.raw_data.get('summary', '')
    )
    desc_snippet = clean_desc[:3000]

    # 3. æ„å»ºç´ ææ‘˜è¦
    candidates_summary.append(f"""
        ã€ç´ æ #{idx}ã€‘
        æ¥æº: {item.platform} | ç±»å‹: {item.source_type}
        æ ‡é¢˜: {item.title}
        æ•°æ®: æ’­æ”¾ {item.view_count} | äº’åŠ¨ {item.interaction}
        åšä¸»: {item.author_name}
        æ ¸å¿ƒå†…å®¹æ‘˜è¦:
        {desc_snippet}  # ğŸ”‘ ç®€ä»‹å·²æå–ï¼
    """)

# 4. ä¼ ç»™ LLM ç”Ÿæˆé€‰é¢˜
context_str = "\n".join(candidates_summary)
result = llm.call_with_schema(..., context=context_str)
```

**é‡è¦å‘ç°**:
- âœ… Architect **å·²ç»æå–äº†è§†é¢‘ç®€ä»‹**ï¼ˆdescription/summaryï¼‰
- âœ… è¿™äº›ç®€ä»‹**ä¼ ç»™äº† LLM**ï¼Œç”¨äºç”Ÿæˆé€‰é¢˜
- â“ **ä½†ç”Ÿæˆçš„ TopicBrief çš„ `reference_data` åŒ…å«ä»€ä¹ˆï¼Ÿ**

---

### 1.4 æ¨æ–­ï¼šreference_data å®é™…åŒ…å«çš„å†…å®¹

**é—®é¢˜**: Architect ä»£ç ä¸­æ²¡æœ‰æ˜ç¡®å¡«å…… `reference_data`

**æŸ¥çœ‹ TopicBriefList å®šä¹‰**:
```python
# architect.py:8-10
class TopicBriefList(BaseModel):
    proposals: List[TopicBrief]
```

**å…³é”®ä»£ç **:
```python
# architect.py:70-75
result: TopicBriefList = llm.call_with_schema(
    user_prompt=user_prompt,
    system_prompt=system_prompt,
    schema_model=TopicBriefList,
    capability="creative"
)
proposals = result.proposals
```

**æ¨æ–­**:
- LLM ç”Ÿæˆ TopicBrief æ—¶ï¼Œéœ€è¦å¡«å…… `reference_data` å­—æ®µ
- ä½† LLM **ä¸çŸ¥é“å…·ä½“çš„ ContentItem ç»“æ„**
- å¯èƒ½åªç”Ÿæˆäº†ç®€åŒ–çš„å¼•ç”¨ï¼ˆå¦‚ "ç´ æ#2"ï¼‰

**éªŒè¯æ–¹æ³•**: æŸ¥çœ‹ç”¨æˆ·æ—¥å¿—ä¸­çš„ `æ”¯æ’‘æ•°æ®: 2 æ¡å†…å®¹`

**ä»æ—¥å¿—æ¨æ–­**:
```
ã€é€‰é¢˜ 1ã€‘
...
æ”¯æ’‘æ•°æ®: 2 æ¡å†…å®¹
```

è¯´æ˜ `reference_data` è‡³å°‘æœ‰é•¿åº¦ä¿¡æ¯ï¼Œä½†**å…·ä½“å†…å®¹æœªçŸ¥**ã€‚

---

## ğŸ” Step 2: å½“å‰ Analyst çš„é—®é¢˜åˆ†æ

### 2.1 Scout å½“å‰çš„è¾“å…¥

**ä»£ç ä½ç½®**: `nodes/analyst.py:34-59`

```python
user_prompt = f"""
You are a senior research strategist. Given a topic, determine the BEST sources to find authoritative information.

**Topic Brief**:
- Title: {topic_brief.title}
- Core Angle: {topic_brief.core_angle}
- Rationale: {topic_brief.rationale}
- Source Type: {topic_brief.source_type}  # ğŸ”‘ æœ‰ä¼ 

**Your Task**: Design a research plan to find PRIMARY sources (first-hand information).

**Category Classification Rules**:
1. **tech_ai**: AI, ML, software engineering, new frameworks
   - Primary Sources: Arxiv, GitHub, Official Docs, Technical Blogs
   - Search Actions: arxiv_search, web_search(site:github.com), web_search(official documentation)

2. **business_finance**: Business models, market trends, financial analysis
   - Primary Sources: Research Reports, Financial Statements, Macro Data
   - Search Actions: web_search(site:sec.gov), web_search(filetype:pdf report), web_search(industry analysis)

3. **social_cognition**: Psychology, sociology, human behavior
   - Primary Sources: Books, Interviews, Psychology Studies, Academic Papers
   - Search Actions: web_search(interview transcript), web_search(psychology study), arxiv_search(category:q-bio)

4. **general**: Mixed or unclear category
   - Primary Sources: High-quality journalism, expert blogs, curated sources
   - Search Actions: web_search(authoritative sources), web_search(expert analysis)
"""
```

**é—®é¢˜æ€»ç»“**:
1. âŒ **æ²¡æœ‰ä¼ é€’ `reference_data`**: æœ€å®è´µçš„ä¿¡æ¯ä¸¢å¤±
2. âŒ **`source_type` ä¼ äº†ä½†æ²¡è§£é‡Š**: LLM ä¸çŸ¥é“ "search" æ„å‘³ç€ä»€ä¹ˆ
3. âŒ **å¼ºåˆ¶åˆ†ç±»é€»è¾‘**: ç”¨ç¡¬ç¼–ç çš„ if-else æ›¿ä»£äº†æ¨ç†
4. âŒ **å­¦æœ¯åŒ–å€¾å‘**: æ‰€æœ‰åˆ†ç±»éƒ½å€¾å‘å­¦æœ¯èµ„æºï¼ˆArxivã€ç ”æŠ¥ã€è®ºæ–‡ï¼‰
5. âŒ **å¿½ç•¥å¹³å°ç‰¹æ€§**: ä¸çŸ¥é“è¿™æ˜¯ä» "Bç«™çˆ†æ¬¾è§†é¢‘" æ¥çš„é€‰é¢˜

---

### 2.2 å®é™…æ¡ˆä¾‹åˆ†æ

**ç”¨æˆ·é€‰é¢˜**:
```
æ ‡é¢˜: ã€3å¤©å®æµ‹ã€‘æˆ‘ç”¨"2+3+5"+è´¹æ›¼æ¨¡å‹ï¼ŒæŠŠæ‹–å»¶ç—‡ç åˆ°0ï¼
æ¥æº: search (Bç«™æœç´¢)
reference_data: 2æ¡Bç«™è§†é¢‘ï¼ˆ11.9wå’Œ11.5wæ’­æ”¾ï¼‰
```

**Scout çš„åˆ†ç±»ç»“æœ**:
```
Category: social_cognition
Strategy: Locate peer-reviewed studies...
Search Instructions:
  1. web_search | "2-3-5 time blocking" procrastination study filetype:pdf site:pubmed.ncbi.nlm.nih.gov
  2. arxiv_search | Feynman technique learning procrastination quantitative
  3. web_search | "self-experiment" "time slicing" "raw data" site:osf.io OR site:github.com
  4. web_search | interview "Feynman technique" creator OR Feynman verbatim transcript
  5. web_search | "time blocking" "procrastination" statistics "effect size" site:apa.org
```

**æœç´¢ç»“æœ**:
- 12ä¸ªæ¥æºï¼Œåªæœ‰4ä¸ªæå–åˆ°insightsï¼ˆ67%æ— å…³ï¼‰
- æ‰¾åˆ°çš„éƒ½æ˜¯ï¼šã€Šè´¹æ›¼ç‰©ç†è®²ä¹‰ã€‹ã€å­¦æœ¯è®ºæ–‡ã€æ•°æ®é›†

**é—®é¢˜æ ¹æº**:
1. **è¯¯åˆ¤é€‰é¢˜æ€§è´¨**: è¿™æ˜¯"Bç«™å®æˆ˜æ–¹æ³•"ï¼Œä¸æ˜¯"å¿ƒç†å­¦ç ”ç©¶"
2. **æœ¯è¯­ç¿»è¯‘é”™è¯¯**: "2+3+5" æ˜¯Bç«™é»‘è¯ï¼Œç¿»è¯‘æˆ "2-3-5 time blocking" å®Œå…¨è¯¯è§£
3. **æœç´¢å¹³å°é”™è¯¯**: åº”è¯¥æœBç«™ã€çŸ¥ä¹ã€å°çº¢ä¹¦ï¼Œè€Œä¸æ˜¯ PubMed
4. **æµªè´¹å·²æœ‰ç´ æ**: 2æ¡é«˜è´¨é‡Bç«™è§†é¢‘æ²¡ç”¨

---

## ğŸ’¡ Step 3: æ„å›¾é©±åŠ¨æ–¹æ¡ˆè®¾è®¡

### 3.1 æ ¸å¿ƒæ€æƒ³

**ä»**:
```
çœ‹æ ‡é¢˜ â†’ åˆ†ç±»ï¼ˆsocial_cognitionï¼‰â†’ æŸ¥è¡¨ï¼ˆæœè®ºæ–‡ï¼‰â†’ æ‰§è¡Œ
```

**åˆ°**:
```
ç†è§£é€‰é¢˜æ„å›¾ â†’ åˆ†æå·²æœ‰ç´ æ â†’ æ¨ç†æœ€ä¼˜ç­–ç•¥ â†’ æ‰§è¡Œ
```

---

### 3.2 æ–°çš„ Scout Prompt è®¾è®¡

#### è®¾è®¡åŸåˆ™
1. **æ„å›¾ä¼˜å…ˆ**: é—® "ä¸ºä»€ä¹ˆè¦åˆ†æè¿™ä¸ªé€‰é¢˜ï¼Ÿ" è€Œä¸æ˜¯ "å®ƒå±äºå“ªä¸ªç±»åˆ«ï¼Ÿ"
2. **ä¸Šä¸‹æ–‡å®Œæ•´**: ä¼ é€’æ‰€æœ‰å¯ç”¨ä¿¡æ¯ï¼ˆreference_data, source_type, platformï¼‰
3. **æ¨ç†å¼•å¯¼**: ç”¨æ€è€ƒé“¾å¼•å¯¼ LLM æ¨ç†ï¼Œè€Œä¸æ˜¯ç»™å›ºå®šé€‰é¡¹
4. **å®æˆ˜å¯¼å‘**: å¼ºè°ƒå®æˆ˜èµ„æºï¼ˆç¤¾åŒºã€æ•™ç¨‹ï¼‰è€Œéå­¦æœ¯èµ„æº

---

#### Prompt è‰ç¨¿ï¼ˆä¸­æ–‡ç‰ˆï¼‰

```markdown
# ä½ çš„ä»»åŠ¡ï¼šè®¾è®¡æœ€ä¼˜ç ”ç©¶ç­–ç•¥

## èƒŒæ™¯ä¿¡æ¯

**é€‰é¢˜**:
- æ ‡é¢˜: {topic_title}
- åˆ‡å…¥ç‚¹: {core_angle}
- æ¨èç†ç”±: {rationale}
- æ¥æºç±»å‹: {source_type}
  ï¼ˆè¯´æ˜: "search" = ä»è§†é¢‘å¹³å°æœç´¢å¾—åˆ°, "viral_hit" = çˆ†æ¬¾è§†é¢‘, "competitor" = ç«å“åˆ†æï¼‰

**å·²æœ‰ç´ æ** (è¿™äº›æ˜¯æˆ‘ä»¬å·²ç»æ”¶é›†åˆ°çš„é«˜è´¨é‡å†…å®¹):
{len(reference_data)} æ¡ç´ æï¼Œæ¥è‡ª {platforms}

ç¤ºä¾‹ç´ æ:
{for item in reference_data[:3]}
  - [{item.platform}] {item.title}
    æ’­æ”¾: {item.view_count} | ä½œè€…: {item.author_name}
    ç®€ä»‹: {item.raw_data.get('description', '')[:200]}...
{endfor}

---

## ä½ çš„æ¨ç†è¿‡ç¨‹ï¼ˆè¯·é€æ­¥æ€è€ƒï¼‰

### Step 1: ç†è§£é€‰é¢˜çš„çœŸå®æ„å›¾

**æ€è€ƒ**:
1. è¿™ä¸ªé€‰é¢˜çš„æ ¸å¿ƒä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ
   - [ ] ç†è®ºéªŒè¯ï¼ˆéœ€è¦å­¦æœ¯è®ºæ–‡æ”¯æ’‘ï¼‰
   - [ ] å®æˆ˜æ•™ç¨‹ï¼ˆéœ€è¦æ“ä½œæ‰‹å†Œå’Œæ¡ˆä¾‹ï¼‰
   - [ ] è§‚ç‚¹è¯„è®ºï¼ˆéœ€è¦ä¸“å®¶è®¿è°ˆå’Œæ•°æ®ï¼‰
   - [ ] æ¡ˆä¾‹åˆ†äº«ï¼ˆéœ€è¦çœŸå®ç»éªŒå’Œæ•…äº‹ï¼‰

2. ç›®æ ‡å—ä¼—æ˜¯è°ï¼Ÿ
   - [ ] å­¦æœ¯ç ”ç©¶è€…
   - [ ] æ™®é€šç”¨æˆ·ï¼ˆæƒ³è§£å†³å®é™…é—®é¢˜ï¼‰
   - [ ] ä¸“ä¸šä»ä¸šè€…
   - [ ] å…´è¶£çˆ±å¥½è€…

3. è¿™ä¸ªé€‰é¢˜æ¥è‡ªå“ªé‡Œï¼Ÿ
   - å¦‚æœæ¥è‡ª "Bilibili æœç´¢" â†’ å¯èƒ½æ˜¯å®æˆ˜æ–¹æ³•ã€æ•™ç¨‹ç±»
   - å¦‚æœæ¥è‡ª "YouTube çˆ†æ¬¾" â†’ å¯èƒ½æ˜¯ç§‘æ™®ã€è¯„æµ‹ç±»
   - å¦‚æœæ¥è‡ª "Web æ–‡ç« " â†’ å¯èƒ½æ˜¯æ–°é—»ã€è§‚ç‚¹ç±»

**ä½ çš„åˆ¤æ–­**:
ï¼ˆè¯·ç”¨1-2å¥è¯è¯´æ˜ä½ å¯¹è¿™ä¸ªé€‰é¢˜çš„ç†è§£ï¼‰

---

### Step 2: åˆ†æå·²æœ‰ç´ æ

**æ€è€ƒ**:
1. å·²æœ‰çš„ {len(reference_data)} æ¡ç´ ææ¥è‡ª {platforms}ï¼Œè¯´æ˜ä»€ä¹ˆï¼Ÿ
   - å¦‚æœéƒ½æ˜¯è§†é¢‘ â†’ å¯èƒ½æœ‰è¯¦ç»†çš„æ“ä½œæ¼”ç¤º
   - å¦‚æœéƒ½æ˜¯æ–‡ç«  â†’ å¯èƒ½æœ‰æ·±å…¥çš„åˆ†æ
   - å¦‚æœæ’­æ”¾é‡é«˜ â†’ è¯´æ˜è¯é¢˜æœ‰çƒ­åº¦

2. è¿™äº›ç´ æçš„æ ‡é¢˜æš—ç¤ºäº†ä»€ä¹ˆä¿¡æ¯ï¼Ÿ
   - ä¾‹å¦‚: "ä¿å§†çº§æ•™ç¨‹" â†’ å®æˆ˜å¯¼å‘
   - ä¾‹å¦‚: "æ·±åº¦è§£æ" â†’ ç†è®ºå¯¼å‘
   - ä¾‹å¦‚: "3å¤©å®æµ‹" â†’ æ¡ˆä¾‹å¯¼å‘

3. è¿™äº›ç´ æå·²ç»è¦†ç›–äº†å“ªäº›å†…å®¹ï¼Ÿè¿˜ç¼ºä»€ä¹ˆï¼Ÿ
   - å·²æœ‰: ...
   - ç¼ºå°‘: ...

**ä½ çš„åˆ¤æ–­**:
ï¼ˆè¯·è¯´æ˜å·²æœ‰ç´ æçš„ä»·å€¼å’Œç¼ºå£ï¼‰

---

### Step 3: è®¾è®¡æœç´¢ç­–ç•¥

åŸºäºä»¥ä¸Šåˆ†æï¼Œä½ åº”è¯¥ï¼š

**ä¼˜å…ˆçº§ 1 - å…ˆåšä»€ä¹ˆï¼Ÿ**

é€‰é¡¹A: æ·±åº¦åˆ†æå·²æœ‰ç´ æ
- å¦‚æœå·²æœ‰ç´ ææ•°é‡ >= 2 ä¸”è´¨é‡é«˜ï¼ˆæ’­æ”¾é‡ > 10wï¼‰
- å¦‚æœç´ æå¯èƒ½åŒ…å«è¯¦ç»†ä¿¡æ¯ï¼ˆè§†é¢‘æœ‰ç®€ä»‹ã€æ–‡ç« æœ‰å…¨æ–‡ï¼‰
- **åŠ¨ä½œ**: æå–å·²æœ‰ç´ æçš„ç®€ä»‹ã€è¯„è®ºã€å…³é”®ä¿¡æ¯

é€‰é¡¹B: æœç´¢è¡¥å……èµ„æ–™
- å¦‚æœå·²æœ‰ç´ æä¸è¶³æˆ–ç¼ºå°‘æŸä¸ªè§’åº¦
- **åŠ¨ä½œ**: æ ¹æ®ç¼ºå£æœç´¢å¯¹åº”èµ„æº

**ä½ çš„é€‰æ‹©**: A / B
**ç†ç”±**: ...

---

**ä¼˜å…ˆçº§ 2 - æœç´¢ä»€ä¹ˆï¼Ÿ**

å¦‚æœé€‰æ‹©äº†æœç´¢ï¼Œè¯·æ ¹æ®é€‰é¢˜æ€§è´¨å†³å®šï¼š

**å®æˆ˜ç±»é€‰é¢˜**ï¼ˆå¦‚: å­¦ä¹ æ–¹æ³•ã€æ•ˆç‡æŠ€å·§ã€å·¥å…·æ•™ç¨‹ï¼‰:
- ğŸ¯ ä¼˜å…ˆ: ä¸­æ–‡å®æˆ˜ç¤¾åŒº
  - çŸ¥ä¹ï¼ˆç»éªŒåˆ†äº«ï¼‰
  - å°çº¢ä¹¦ï¼ˆæ¡ˆä¾‹æ•™ç¨‹ï¼‰
  - Bç«™ä¸“æ ï¼ˆè¯¦ç»†æ”»ç•¥ï¼‰
- ğŸ¯ æ¬¡è¦: è‹±æ–‡å®æˆ˜èµ„æº
  - Redditï¼ˆr/productivity, r/learnprogrammingï¼‰
  - Mediumï¼ˆå®æˆ˜åšå®¢ï¼‰
  - GitHubï¼ˆå®ç”¨å·¥å…·ã€æ¨¡æ¿ï¼‰
- âŒ é¿å…: å­¦æœ¯è®ºæ–‡ï¼ˆå¤ªç†è®ºï¼Œä¸é€‚åˆå®æˆ˜ï¼‰

**ç†è®ºç±»é€‰é¢˜**ï¼ˆå¦‚: æŠ€æœ¯åŸç†ã€ç®—æ³•åˆ†æã€å­¦æœ¯ç»¼è¿°ï¼‰:
- ğŸ¯ ä¼˜å…ˆ: å­¦æœ¯èµ„æº
  - Arxivï¼ˆæœ€æ–°è®ºæ–‡ï¼‰
  - GitHubï¼ˆå¼€æºå®ç°ï¼‰
  - å®˜æ–¹æ–‡æ¡£ï¼ˆæŠ€æœ¯è§„èŒƒï¼‰
- ğŸ¯ æ¬¡è¦: æŠ€æœ¯åšå®¢
  - ä¸ªäººæŠ€æœ¯åšå®¢
  - å…¬å¸æŠ€æœ¯åšå®¢
- âŒ é¿å…: è¥é”€å·æ–‡ç« 

**è§‚ç‚¹ç±»é€‰é¢˜**ï¼ˆå¦‚: è¡Œä¸šåˆ†æã€è¶‹åŠ¿é¢„æµ‹ã€äº‰è®®è¯é¢˜ï¼‰:
- ğŸ¯ ä¼˜å…ˆ: æƒå¨è§‚ç‚¹
  - ä¸“å®¶è®¿è°ˆ
  - è¡Œä¸šæŠ¥å‘Š
  - å®˜æ–¹å£°æ˜
- ğŸ¯ æ¬¡è¦: ç¤¾åŒºè®¨è®º
  - çŸ¥ä¹é«˜èµå›ç­”
  - HackerNews è®¨è®º
- âŒ é¿å…: æœªç»è¯å®çš„æ¶ˆæ¯

**ä½ çš„åˆ¤æ–­**: æœ¬é€‰é¢˜å±äº [å®æˆ˜/ç†è®º/è§‚ç‚¹] ç±»
**æœç´¢ç­–ç•¥**: ...

---

**ä¼˜å…ˆçº§ 3 - å¦‚ä½•æœç´¢ï¼Ÿ**

**å…³é”®è¯è®¾è®¡**:
- å¦‚æœé€‰é¢˜åŒ…å«ä¸­æ–‡ä¿—è¯­/é»‘è¯ï¼ˆå¦‚ "2+3+5"ï¼‰â†’ ä¿ç•™ä¸­æ–‡æœç´¢
- å¦‚æœæ˜¯é€šç”¨æ¦‚å¿µ â†’ ä¸­è‹±æ–‡ç»“åˆ
- é¿å…: ç›´è¯‘ä¸“æœ‰åè¯ï¼ˆä¼šä¸¢å¤±è¯­å¢ƒï¼‰

**å¹³å°é€‰æ‹©**:
- ä¸­æ–‡å†…å®¹ â†’ çŸ¥ä¹ã€å°çº¢ä¹¦ã€Bç«™ä¸“æ 
- è‹±æ–‡å†…å®¹ â†’ Reddit, Medium, GitHub
- å­¦æœ¯å†…å®¹ â†’ Arxiv, Google Scholar
- å®˜æ–¹å†…å®¹ â†’ å®˜ç½‘ã€æ–‡æ¡£ã€ç™½çš®ä¹¦

**ä½ çš„æœç´¢æŒ‡ä»¤**:
ï¼ˆè¯·è®¾è®¡ 3-5 ä¸ªå…·ä½“çš„æœç´¢åŠ¨ä½œï¼‰

---

## è¾“å‡ºæ ¼å¼

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ JSON Schema è¾“å‡º:

```json
{
  "intent_analysis": "è¿™æ˜¯ä¸€ä¸ª[å®æˆ˜/ç†è®º/è§‚ç‚¹]ç±»é€‰é¢˜ï¼Œç›®æ ‡å—ä¼—æ˜¯[å­¦è€…/æ™®é€šç”¨æˆ·/ä¸“ä¸šäººå£«]ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äº[ç†è®ºéªŒè¯/å®æˆ˜æŒ‡å¯¼/æ¡ˆä¾‹åˆ†äº«]",

  "existing_coverage": "å·²æœ‰ç´ æè¦†ç›–äº†[å…·ä½“å†…å®¹]ï¼Œä½†ç¼ºå°‘[å…·ä½“ç¼ºå£]",

  "search_strategy": "åº”è¯¥ä¼˜å…ˆ[åˆ†æå·²æœ‰ç´ æ/æœç´¢è¡¥å……èµ„æ–™]ï¼Œç„¶å[å…·ä½“æ­¥éª¤]",

  "search_instructions": [
    {
      "priority": 1,
      "tool": "analyze_existing" | "web_search" | "arxiv_search",
      "query": "å…·ä½“æœç´¢è¯ï¼ˆå¦‚æœæ˜¯ analyze_existing åˆ™ä¸ºç©ºï¼‰",
      "target": "æœŸæœ›æ‰¾åˆ°ä»€ä¹ˆ",
      "reasoning": "ä¸ºä»€ä¹ˆè¿™æ ·æœç´¢"
    },
    ...
  ]
}
```

**é‡è¦**:
- æ‰€æœ‰è¾“å‡ºå¿…é¡»ä½¿ç”¨ä¸­æ–‡
- æœç´¢è¯ä¿æŒåŸè¯­å¢ƒï¼ˆä¸­æ–‡ä¿—è¯­ä¸è¦ç¿»è¯‘ï¼‰
- ä¼˜å…ˆåˆ©ç”¨å·²æœ‰ç´ æï¼Œé¿å…é‡å¤æœç´¢
```

---

### 3.3 æ–°å¢å·¥å…·ï¼šanalyze_existing

**åŠŸèƒ½**: åˆ†æå·²æœ‰çš„ reference_dataï¼Œæå–å…³é”®ä¿¡æ¯

**å®ç°æ€è·¯**:
```python
def analyze_existing_materials(reference_data: List[Dict]) -> List[KeyInsight]:
    """
    ä»å·²æœ‰ç´ æä¸­æå–å…³é”®ä¿¡æ¯

    é€»è¾‘:
    1. éå† reference_data
    2. æå–æ¯ä¸ªç´ æçš„:
       - æ ‡é¢˜ï¼ˆå·²æœ‰é«˜åº¦æ¦‚æ‹¬æ€§ï¼‰
       - ç®€ä»‹/æ‘˜è¦ï¼ˆå¦‚æœæœ‰ raw_data.descriptionï¼‰
       - æ•°æ®æŒ‡æ ‡ï¼ˆæ’­æ”¾é‡ã€äº’åŠ¨ç‡ â†’ è¯´æ˜è¯é¢˜çƒ­åº¦ï¼‰
    3. ç”¨ LLM èƒå–å…³é”®æ´å¯Ÿ
    """
    insights = []

    for item in reference_data:
        # æå–å¯ç”¨ä¿¡æ¯
        title = item.get('title', '')
        description = item.get('raw_data', {}).get('description', '')
        platform = item.get('platform', '')
        view_count = item.get('view_count', 0)

        # æ„å»ºèƒå– prompt
        prompt = f"""
        è¿™æ˜¯ä¸€ä¸ªæ¥è‡ª {platform} çš„é«˜è´¨é‡å†…å®¹:

        æ ‡é¢˜: {title}
        æ’­æ”¾é‡: {view_count}
        ç®€ä»‹: {description[:500]}

        è¯·æå–:
        1. æ ¸å¿ƒæ–¹æ³•/è§‚ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ
        2. æœ‰ä»€ä¹ˆå…³é”®æ•°æ®æˆ–æ¡ˆä¾‹ï¼Ÿ
        3. è¯„è®ºåŒºå¯èƒ½å…³æ³¨ä»€ä¹ˆé—®é¢˜ï¼Ÿ
        """

        insight = llm_extract(prompt)
        insights.append(insight)

    return insights
```

---

## ğŸ¯ Step 4: è¾“å‡ºè¯­è¨€é—®é¢˜

### 4.1 å½“å‰é—®é¢˜

**ç°è±¡**: æ‰€æœ‰ Analyst è¾“å‡ºéƒ½æ˜¯è‹±æ–‡

**æ ¹æœ¬åŸå› **:
1. System prompt æ˜¯è‹±æ–‡
2. User prompt æ˜¯è‹±æ–‡
3. æ²¡æœ‰æ˜ç¡®æŒ‡å®šè¾“å‡ºè¯­è¨€

---

### 4.2 è§£å†³æ–¹æ¡ˆ

**æ–¹æ¡ˆA: System Prompt åŠ ä¸­æ–‡æŒ‡ä»¤**

```python
system_prompt = """
ä½ æ˜¯ä¸–ç•Œçº§çš„æ·±åº¦åˆ†æä¸“å®¶ã€‚

**æ ¸å¿ƒåŸåˆ™**:
1. æ‰€æœ‰è¾“å‡ºå¿…é¡»ä½¿ç”¨ä¸­æ–‡
2. åŸºäºäº‹å®ï¼Œæ‹’ç»ç¼–é€ 
3. è¿½æ±‚åç›´è§‰æ´å¯Ÿ

è¯·åˆ†æç»™å®šçš„æƒ…æŠ¥å¡ç‰‡ï¼Œè¾“å‡ºæ·±åº¦åˆ†ææŠ¥å‘Šã€‚
"""
```

**æ–¹æ¡ˆB: User Prompt ç»“å°¾å¼ºè°ƒ**

```python
user_prompt = f"""
...

**Now, analyze the intelligence cards and produce your DeepAnalysisReport.**

**CRITICAL**:
- æ‰€æœ‰å­—æ®µå¿…é¡»ä½¿ç”¨ä¸­æ–‡è¾“å‡º
- åŒ…æ‹¬ root_cause, mainstream_view, contrarian_view ç­‰
- ä¿æŒä¸“ä¸šæ€§å’Œæ·±åº¦
"""
```

**æ–¹æ¡ˆC: ä¸¤è€…ç»“åˆ**ï¼ˆæ¨èï¼‰

---

### 4.3 æµ‹è¯•è®¡åˆ’

1. ä¿®æ”¹ `nodes/analyst.py` ä¸­çš„æ‰€æœ‰ system_prompt
2. åœ¨æ‰€æœ‰ user_prompt ç»“å°¾åŠ  "è¯·ç”¨ä¸­æ–‡è¾“å‡º"
3. æµ‹è¯•ä¸€ä¸ªçœŸå®é€‰é¢˜ï¼ŒéªŒè¯è¾“å‡ºè¯­è¨€

---

## ğŸ“‹ Step 5: è°ƒç ”ç»“è®º

### 5.1 æ•°æ®ç»“æ„ç»“è®º

| å­—æ®µ | æ˜¯å¦å­˜åœ¨ | æ˜¯å¦è¢«åˆ©ç”¨ | åŒ…å«ä¿¡æ¯ |
|------|----------|------------|----------|
| `title` | âœ… | âœ… | é€‰é¢˜æ ‡é¢˜ |
| `core_angle` | âœ… | âœ… | åˆ‡å…¥ç‚¹ |
| `rationale` | âœ… | âœ… | æ¨èç†ç”± |
| `source_type` | âœ… | âš ï¸ ä¼ äº†ä½†æ²¡ç”¨ | æ¥æºç±»å‹ |
| `reference_data` | âœ… | âŒ å®Œå…¨å¿½ç•¥ | **æœ€å®è´µçš„ç´ æä¿¡æ¯** |

**å…³é”®å‘ç°**:
- `reference_data` åŒ…å«å·²ç­›é€‰çš„é«˜è´¨é‡ç´ æ
- æ¯æ¡ç´ ææœ‰: æ ‡é¢˜ã€æ’­æ”¾é‡ã€ä½œè€…ã€å¯èƒ½çš„ç®€ä»‹
- Architect å·²ç»æå–äº†ç®€ä»‹ï¼Œä½†ä¼ ç»™ Analyst æ—¶ä¸¢å¤±äº†

---

### 5.2 æœç´¢èƒ½åŠ›ç»“è®º

**æµ‹è¯•ç»“æœ**: æ— æ³•éªŒè¯ï¼ˆéœ€è¦ API keyï¼‰

**æ¨æµ‹**:
- Tavily å¯èƒ½æ”¯æŒä¸­æ–‡æœç´¢ï¼Œä½†æ•ˆæœæœªçŸ¥
- æ²¡æœ‰ä¸“é—¨çš„çŸ¥ä¹ã€å°çº¢ä¹¦æœç´¢å·¥å…·
- éœ€è¦è®¾è®¡é€šç”¨çš„ web_search ç­–ç•¥

---

### 5.3 æ ¸å¿ƒé—®é¢˜æ€»ç»“

**P0 é—®é¢˜**:
1. âŒ **reference_data æµªè´¹**: æœ€æœ‰ä»·å€¼çš„ä¿¡æ¯æ²¡ç”¨
2. âŒ **åˆ†ç±»é©±åŠ¨åƒµåŒ–**: é™åˆ¶äº† LLM çš„æ¨ç†èƒ½åŠ›
3. âŒ **è¾“å‡ºè¯­è¨€é”™è¯¯**: ç”¨æˆ·çœ‹ä¸æ‡‚è‹±æ–‡æŠ¥å‘Š

**P1 é—®é¢˜**:
4. âš ï¸ **source_type æœªè§£é‡Š**: LLM ä¸çŸ¥é“å«ä¹‰
5. âš ï¸ **æœç´¢ç­–ç•¥å­¦æœ¯åŒ–**: æ‰€æœ‰é€‰é¢˜éƒ½æœè®ºæ–‡
6. âš ï¸ **æœ¯è¯­ç¿»è¯‘é”™è¯¯**: ä¸­æ–‡é»‘è¯è¢«è¯¯è¯‘

---

## ğŸš€ Step 6: å®æ–½å»ºè®®

### ä¼˜å…ˆçº§ P0ï¼ˆç«‹å³ä¿®å¤ï¼‰

#### 1. è¾“å‡ºä¸­æ–‡ï¼ˆå½±å“ç”¨æˆ·ä½“éªŒï¼‰

**ä¿®æ”¹æ–‡ä»¶**: `nodes/analyst.py`

**ä¿®æ”¹ç‚¹**:
- `plan_research_strategy()`: system_prompt æ”¹ä¸­æ–‡
- `deep_analysis()`: system_prompt æ”¹ä¸­æ–‡ + user_prompt åŠ  "è¯·ç”¨ä¸­æ–‡è¾“å‡º"
- `extract_insights()`: system_prompt æ”¹ä¸­æ–‡

**é¢„è®¡å·¥ä½œé‡**: 30åˆ†é’Ÿ

---

#### 2. ä¼ é€’ reference_dataï¼ˆæœ€å¤§ä»·å€¼æå‡ï¼‰

**ä¿®æ”¹æ–‡ä»¶**: `nodes/analyst.py`

**ä¿®æ”¹ç‚¹**:
```python
def plan_research_strategy(topic_brief: TopicBrief) -> ResearchPlan:
    # ğŸ”‘ æ–°å¢: ä¼ é€’ reference_data
    reference_summary = _summarize_reference_data(topic_brief.reference_data)

    user_prompt = f"""
    **é€‰é¢˜**:
    - æ ‡é¢˜: {topic_brief.title}
    - åˆ‡å…¥ç‚¹: {topic_brief.core_angle}
    - æ¥æºç±»å‹: {topic_brief.source_type}

    **å·²æœ‰ç´ æ** ({len(topic_brief.reference_data)} æ¡):
    {reference_summary}

    **ä½ çš„ä»»åŠ¡**: ç†è§£é€‰é¢˜æ„å›¾ï¼Œè®¾è®¡æœ€ä¼˜æœç´¢ç­–ç•¥
    ...
    """
```

**é¢„è®¡å·¥ä½œé‡**: 1å°æ—¶

---

### ä¼˜å…ˆçº§ P1ï¼ˆæ ¸å¿ƒé‡æ„ï¼‰

#### 3. é‡å†™ Prompt ä¸ºæ„å›¾é©±åŠ¨

**ä¿®æ”¹æ–‡ä»¶**: `nodes/analyst.py`

**ä¿®æ”¹ç‚¹**: å‚ç…§ Step 3.2 çš„ Prompt è‰ç¨¿

**é¢„è®¡å·¥ä½œé‡**: 2å°æ—¶

---

#### 4. å®ç° analyze_existing å·¥å…·

**æ–°å¢æ–‡ä»¶**: `nodes/analyst.py` å†…éƒ¨å‡½æ•°

**åŠŸèƒ½**: å‚ç…§ Step 3.3

**é¢„è®¡å·¥ä½œé‡**: 1å°æ—¶

---

## ğŸ“Š é¢„æœŸæ•ˆæœå¯¹æ¯”

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| **è¾“å‡ºè¯­è¨€** | è‹±æ–‡ | ä¸­æ–‡ âœ… |
| **æœç´¢ç›¸å…³æ€§** | 33% (4/12) | é¢„è®¡ 70%+ |
| **å·²æœ‰ç´ æåˆ©ç”¨ç‡** | 0% | 100% âœ… |
| **æœç´¢ç­–ç•¥å‡†ç¡®æ€§** | åˆ†ç±»é”™è¯¯ | æ„å›¾é©±åŠ¨ âœ… |
| **ç”¨æˆ·å¯è¯»æ€§** | éœ€è¦ç¿»è¯‘ | ç›´æ¥å¯ç”¨ âœ… |

---

## ğŸ¯ å»ºè®®çš„å®æ–½æ­¥éª¤

**ç¬¬ä¸€æ­¥** (30åˆ†é’Ÿ):
- ä¿®å¤è¾“å‡ºè¯­è¨€é—®é¢˜
- éªŒè¯ä¸­æ–‡è¾“å‡º

**ç¬¬äºŒæ­¥** (1å°æ—¶):
- ä¼ é€’ reference_data
- å®ç° `_summarize_reference_data()` è¾…åŠ©å‡½æ•°

**ç¬¬ä¸‰æ­¥** (2å°æ—¶):
- é‡å†™ Scout Promptï¼ˆæ„å›¾é©±åŠ¨ï¼‰
- æµ‹è¯•æœç´¢ç­–ç•¥å‡†ç¡®æ€§

**ç¬¬å››æ­¥** (1å°æ—¶):
- å®ç° analyze_existing å·¥å…·
- å®Œæ•´æµ‹è¯•æµç¨‹

**æ€»è®¡**: çº¦ 4.5 å°æ—¶

---

## ğŸ“ é™„å½•ï¼šä»£ç ä½ç½®ç´¢å¼•

| åŠŸèƒ½ | æ–‡ä»¶ | è¡Œå· |
|------|------|------|
| TopicBrief å®šä¹‰ | `core/state.py` | 66-76 |
| ContentItem å®šä¹‰ | `core/state.py` | 5-19 |
| Architect ç”Ÿæˆé€‰é¢˜ | `nodes/architect.py` | 12-90 |
| Scout è§„åˆ’ç­–ç•¥ | `nodes/analyst.py` | 34-129 |
| Excavator èƒå– | `nodes/analyst.py` | 144-290 |
| Philosopher åˆ†æ | `nodes/analyst.py` | 296-452 |
| Analyst Node å…¥å£ | `nodes/analyst.py` | 537-592 |

---

**è°ƒç ”å®Œæˆæ—¶é—´**: 2025-11-28
**ä¸‹ä¸€æ­¥**: ç­‰å¾…ç”¨æˆ·ç¡®è®¤ä¼˜å…ˆçº§ï¼Œå¼€å§‹å®æ–½
