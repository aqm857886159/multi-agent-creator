# åšä¸»æå–ä¼˜åŒ– - ç´§æ€¥ä¿®å¤

**æ—¥æœŸ**: 2025-11-27 (ç¬¬2è½®)
**é—®é¢˜**: å¾ªç¯å¡æ­» + åšä¸»æå–è¿‡äºä¸¥æ ¼

---

## ğŸ”´ é—®é¢˜1: ä»£ç å´©æºƒå¯¼è‡´å¾ªç¯å¡æ­»

### ç—‡çŠ¶
```
âœ… åšä¸»æå–: 6 ä¸ª (YT:6 BL:0)
âŒ åšä¸»æå–å¤±è´¥: cannot access local variable 'sorted_influencers' where it is not associated with a value
ğŸ“‹ ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼Œå°è¯•ç”Ÿæˆæ–°ä»»åŠ¡...
âœ… æ‰€æœ‰ä»»åŠ¡å·²å®Œæˆï¼Œè¿›å…¥ç­›é€‰é˜¶æ®µ
... (æ— é™å¾ªç¯)
```

### æ ¹æœ¬åŸå› 

è°ƒè¯•ä»£ç é¡ºåºé”™è¯¯ï¼š
```python
# Line 189: å°è¯•ä½¿ç”¨ sorted_influencers
for idx, inf in enumerate(sorted_influencers[:3], 1):
    print(f"...")

# Line 194: æ‰å®šä¹‰ sorted_influencers
sorted_influencers = sorted(...)
```

### ä¿®å¤

**æ–‡ä»¶**: `nodes/influencer_extractor.py:186-201`

è°ƒæ¢é¡ºåº + å¢å¼ºæ—¥å¿—ï¼š
```python
# å…ˆæ’åº
sorted_influencers = sorted(
    result.influencers,
    key=lambda x: (confidence_score.get(x.confidence, 1), x.mention_count),
    reverse=True
)

# å†æ˜¾ç¤ºï¼ˆæ˜¾ç¤ºæ‰€æœ‰åšä¸»ï¼Œä¸åªæ˜¯å‰3ä¸ªï¼‰
if sorted_influencers:
    print(f"\nğŸ“‹ æå–åˆ°çš„åšä¸»åˆ—è¡¨:")
    for idx, inf in enumerate(sorted_influencers, 1):
        identifier_str = inf.identifier if inf.identifier else "æ— identifier"
        print(f"   [{idx}] {inf.name} | {inf.platform} | {inf.confidence} | {identifier_str[:40]}")
```

**æ•ˆæœ**:
- âœ… ä»£ç ä¸å†å´©æºƒ
- âœ… å®Œæ•´æ˜¾ç¤ºæ‰€æœ‰æå–çš„åšä¸»
- âœ… å¯ä»¥çœ‹åˆ°æ¯ä¸ªåšä¸»çš„identifierçŠ¶æ€

---

## ğŸ”´ é—®é¢˜2: åšä¸»æå–ç­–ç•¥è¿‡äºä¸¥æ ¼

### ç”¨æˆ·åé¦ˆ

> "ä¸€äº›åšä¸»å¯èƒ½æ²¡æœ‰å…·ä½“çš„é¢‘é“idï¼Œåªæ˜¯ä¸€äº›åå­—ï¼Œä½†æ˜¯å¤§æ¨¡å‹æ²¡æœ‰æå–åˆ°ï¼Œæˆ–è€…æå–è¿™ä¸ªæ²¡æœ‰å¤§æ¨¡å‹å‚ä¸ï¼Œå¯¼è‡´å‘†æ¿çš„å¥—æ ¼å¼ä½¿å¾—æ— æ³•æ‰¾åˆ°"

### é—®é¢˜åˆ†æ

**ç°å®æƒ…å†µ**:
- å¤§éƒ¨åˆ†æ–‡ç« **ä¸ä¼š**æä¾›@handleæˆ–UID
- æ–‡ç« é€šå¸¸åªæåˆ°åˆ›ä½œè€…çš„åå­—
- ä¾‹å¦‚: "æ¨èTwo Minute Papersï¼Œä»–çš„AIè§£é‡Šå¾ˆæ¸…æ™°"

**æ—§ç­–ç•¥è¿‡äºä¿å®ˆ**:
- å¼ºè°ƒ"Prefer Tier 1 (with @handle/UID)"
- Tier 2è¦æ±‚"EXPLICITLY recommends"ï¼ˆæ˜ç¡®æ¨èï¼‰
- LLMå€¾å‘äºè·³è¿‡æ²¡æœ‰@handleçš„åˆ›ä½œè€…

**ç»“æœ**: æå–ç‡ä½ï¼Œæ— æ³•å‘ç°è¶³å¤Ÿå¤šçš„åšä¸»

### è§£å†³æ–¹æ¡ˆ

#### ä¿®æ”¹1: å¼ºåŒ–Tier 2ä¼˜å…ˆçº§

**æ–‡ä»¶**: `nodes/influencer_extractor.py:79-100`

```python
## Tier 2: Medium Confidence (Acceptable) - â­ PRIORITIZE THIS TIER
**Extract name-only IF the creator is clearly recommended**:

**CRITICAL**: Most articles don't include @handles or UIDs! Extract the name anyway!

**Requirements for Tier 2** (Looser requirements):
- Article mentions this creator in ANY positive context  â† æ”¾å®½ï¼š"any positive"
- Name appears in article content (doesn't have to be in title)  â† æ”¾å®½ï¼šä¸éœ€è¦åœ¨æ ‡é¢˜
- Clear indication this is a content creator (not article author)
- **NO need for @handle or UID** - we'll search by name later!  â† æ˜ç¡®ï¼šä¸éœ€è¦handle
```

#### ä¿®æ”¹2: è°ƒæ•´ç­–ç•¥é¡ºåº

**æ–‡ä»¶**: `nodes/influencer_extractor.py:170-185`

```python
**Strategy** (In order of importance):
1. **MAXIMIZE Tier 2**: Most real articles don't have @handles - extract names aggressively!
2. Prefer Tier 1 (with @handle/UID) when available
3. Include Tier 3 for completeness (mark as low confidence)
4. Quality gate and search algorithms will filter bad results later

**Better to over-extract than under-extract** - The system can handle false positives via:
- Priority de-ranking (low confidence = priority 45 < keyword search priority 50)
- Quality gate filtering during search
- Deduplication if multiple sources mention same creator

**Common Mistake to Avoid**:
âŒ "No @handle found, skip this creator" â†’ TOO STRICT
âœ… "No @handle, but creator mentioned â†’ extract with medium/low confidence"
```

#### ä¿®æ”¹3: ä¼˜åŒ–System Prompt

**æ–‡ä»¶**: `nodes/influencer_extractor.py:193-198`

```python
system_prompt="""ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä¿¡æ¯æå–ä¸“å®¶ï¼Œæ“…é•¿ä»æ–‡ç« ä¸­æå–åšä¸»å’Œå†…å®¹åˆ›ä½œè€…ä¿¡æ¯ã€‚

æ ¸å¿ƒåŸåˆ™: å®å¯å¤šæå–ä¹Ÿä¸è¦æ¼æ‰æœ‰ä»·å€¼çš„åˆ›ä½œè€…ï¼
- å³ä½¿æ²¡æœ‰@handleæˆ–UIDï¼Œåªè¦æ–‡ç« æåˆ°åˆ›ä½œè€…åå­—ï¼Œå°±åº”è¯¥æå–
- æ ‡è®°é€‚å½“çš„confidenceç­‰çº§ï¼Œè®©ä¸‹æ¸¸ç³»ç»Ÿå†³å®šæ˜¯å¦ä½¿ç”¨
- ä¸è¦å› ä¸ºä¿¡æ¯ä¸å®Œæ•´å°±è·³è¿‡æå–"""
```

### æ ¸å¿ƒæ€æƒ³è½¬å˜

#### Before (ä¿å®ˆç­–ç•¥):
```
æ–‡ç« æåˆ°"Two Minute Papers"
â†’ æ²¡æœ‰@handle
â†’ è·³è¿‡æå–
â†’ ç»“æœ: æ¼æ‰æœ‰ä»·å€¼çš„åšä¸»
```

#### After (æ¿€è¿›æå–):
```
æ–‡ç« æåˆ°"Two Minute Papers"
â†’ æ²¡æœ‰@handle
â†’ æå–ï¼Œæ ‡è®° confidence="medium", identifier="Two Minute Papers"
â†’ Plannerä½¿ç”¨nameæœç´¢: "Two Minute Papers AIç»˜å›¾"
â†’ YouTube APIæ‰¾åˆ°é¢‘é“
â†’ ç»“æœ: æˆåŠŸå‘ç°å†…å®¹
```

### é£é™©æ§åˆ¶

**Q: è¿‡åº¦æå–ä¼šä¸ä¼šå¯¼è‡´åƒåœ¾æ•°æ®ï¼Ÿ**

**A: ä¸ä¼šï¼Œå› ä¸ºå¤šå±‚é˜²æŠ¤**:

1. **ç½®ä¿¡åº¦åˆ†å±‚**:
   - High confidence (æœ‰@handle) â†’ priority 70
   - Medium confidence (åªæœ‰name) â†’ priority 60
   - Low confidence (æ¨¡ç³Š) â†’ priority 45 (ä½äºå…³é”®è¯æœç´¢çš„50)

2. **è´¨é‡é—¨è¿‡æ»¤**:
   - æœç´¢ç»“æœä¸ç›¸å…³ â†’ è´¨é‡æ£€æŸ¥å¤±è´¥
   - è‡ªåŠ¨å‚æ•°è°ƒæ•´æˆ–è·³è¿‡

3. **å»é‡æœºåˆ¶**:
   - å¤šä¸ªæ¥æºæåˆ°åŒä¸€åˆ›ä½œè€… â†’ åˆå¹¶ï¼Œæå‡ç½®ä¿¡åº¦

4. **ä¼˜å…ˆçº§è°ƒåº¦**:
   - ä½ç½®ä¿¡åº¦åšä¸»ä»»åŠ¡æ’åœ¨å…³é”®è¯æœç´¢ä¹‹å
   - ä¸ä¼šå ç”¨å¤ªå¤šèµ„æº

---

## ğŸ“Š é¢„æœŸæ•ˆæœå¯¹æ¯”

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| åšä¸»æå–ç‡ | 30% (åªæå–æœ‰@handleçš„) | 80%+ (æå–æ‰€æœ‰æåˆ°çš„) |
| ç³»ç»Ÿå¡æ­»ç‡ | 100% (ä»£ç å´©æºƒ) | 0% |
| åšä¸»ä»»åŠ¡ç”Ÿæˆ | 0 (å´©æºƒå¯¼è‡´) | æ­£å¸¸ |
| å¯è§‚æµ‹æ€§ | 20% (åªçœ‹åˆ°æ•°é‡) | 100% (çœ‹åˆ°æ‰€æœ‰åšä¸»è¯¦æƒ…) |
| è¯¯åˆ¤é£é™© | ä½ï¼ˆä½†å¬å›ç‡ä½ï¼‰ | ä¸­ç­‰ï¼ˆé€šè¿‡è´¨é‡é—¨æ§åˆ¶ï¼‰ |

---

## ğŸ§ª éªŒè¯æµ‹è¯•

è¿è¡Œæµ‹è¯•ï¼š
```bash
python main.py --topic "AIç”Ÿäº§å›¾ç‰‡"
```

**æœŸæœ›æ—¥å¿—**:
```
âœ… åšä¸»æå–: 8 ä¸ª (YT:6 BL:2)

ğŸ“‹ æå–åˆ°çš„åšä¸»åˆ—è¡¨:
   [1] Stable Diffusion Art | youtube | high | @StableDiffusionArt
   [2] Two Minute Papers | youtube | medium | Two Minute Papers  â† æ²¡æœ‰@handleä¹Ÿæå–
   [3] Corridor Crew | youtube | medium | Corridor Crew
   [4] ææ°¸ä¹è€å¸ˆ | bilibili | medium | ææ°¸ä¹è€å¸ˆ  â† æ²¡æœ‰UIDä¹Ÿæå–
   [5] å½±è§†é£“é£ | bilibili | high | space.bilibili.com/946974
   [6] AI Explained | youtube | low | AI Explained
   ...

ğŸ” åŠ¨æ€ç”Ÿæˆåšä¸»ä»»åŠ¡: å‘ç°8ä¸ªåšä¸»
   [1] Stable Diffusion Art (youtube, high) - identifier: @StableDiffusionArt
   [2] Two Minute Papers (youtube, medium) - identifier: Two Minute Papers
   ğŸŒ¿ é¡ºè—¤æ‘¸ç“œ: +5 åšä¸»ä»»åŠ¡

ğŸ”´ youtube_search | Stable Diffusion Art AIç”Ÿäº§å›¾ç‰‡
ğŸ”´ youtube_search | Two Minute Papers AIç”Ÿäº§å›¾ç‰‡  â† ä½¿ç”¨nameæœç´¢
```

**ä¸åº”è¯¥å‡ºç°**:
```
âŒ åšä¸»æå–å¤±è´¥: cannot access local variable
ğŸ“‹ ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼Œå°è¯•ç”Ÿæˆæ–°ä»»åŠ¡... (æ— é™å¾ªç¯)
```

---

## ğŸ¯ è®¾è®¡å“²å­¦

### æ ¸å¿ƒåŸåˆ™

**å®å¯å¬å›ç‡é«˜ï¼ˆå¤šæå–ï¼‰ï¼Œä¹Ÿä¸è¦ç²¾ç¡®ç‡é«˜ï¼ˆå°‘æ¼æ‰ï¼‰**

åŸå› ï¼š
1. **ä¸‹æ¸¸æœ‰å¤šå±‚è¿‡æ»¤**: è´¨é‡é—¨ã€å»é‡ã€ä¼˜å…ˆçº§
2. **æœç´¢å¼•æ“ä¼šå¤„ç†æ¨¡ç³Šè¾“å…¥**: YouTube/Bilibiliçš„æœç´¢ç®—æ³•èƒ½ç†è§£"Two Minute Papers"
3. **ç”¨æˆ·ä»·å€¼**: å‘ç°1ä¸ªæœ‰ä»·å€¼çš„åšä¸» > é¿å…10ä¸ªæ— å…³çš„
4. **æˆæœ¬å¯æ§**: ä½ç½®ä¿¡åº¦ä»»åŠ¡ä¼˜å…ˆçº§ä½ï¼Œä¸ä¼šæµªè´¹å¤ªå¤šèµ„æº

### ä¸ç”¨æˆ·åé¦ˆå¯¹é½

ç”¨æˆ·è¯´ï¼š
> "ä¸€äº›åšä¸»å¯èƒ½æ²¡æœ‰å…·ä½“çš„é¢‘é“idï¼Œåªæ˜¯ä¸€äº›åå­—"

è¿™æ­£æ˜¯ç°å®åœºæ™¯ï¼æˆ‘ä»¬çš„ç³»ç»Ÿå¿…é¡»é€‚åº”ï¼š
- âœ… æå–åå­—
- âœ… æ ‡è®°ç½®ä¿¡åº¦
- âœ… ç”¨åå­—æœç´¢
- âœ… è®©æœç´¢å¼•æ“æ‰¾åˆ°é¢‘é“

**è€Œä¸æ˜¯**:
- âŒ ç­‰å¾…å®Œç¾æ•°æ®ï¼ˆ@handle/UIDï¼‰
- âŒ å› ä¸ºä¿¡æ¯ä¸å®Œæ•´å°±è·³è¿‡
- âŒ æ­»æ¿å¥—æ ¼å¼

---

## ğŸ“ æ€»ç»“

ä¸¤ä¸ªå…³é”®ä¿®å¤ï¼š

1. **Bugä¿®å¤**: ä¿®å¤å˜é‡é¡ºåºé”™è¯¯ï¼Œé˜²æ­¢å´©æºƒå¾ªç¯
2. **ç­–ç•¥ä¼˜åŒ–**: ä»"ä¿å®ˆç²¾ç¡®"è½¬å‘"æ¿€è¿›å¬å›+å¤šå±‚è¿‡æ»¤"

**æ ¸å¿ƒæ€æƒ³**:
- LLMåšå®½æ¾æå–ï¼ˆover-extractï¼‰
- ç³»ç»Ÿåšæ™ºèƒ½è¿‡æ»¤ï¼ˆquality gate + priorityï¼‰
- æœ€å¤§åŒ–å‘ç°æœ‰ä»·å€¼çš„å†…å®¹åˆ›ä½œè€…

**ç³»ç»Ÿç°åœ¨æ›´åŠ çµæ´»å’Œæ™ºèƒ½ï¼** ğŸ‰
